(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-b9f5"],{"/0c0":function(e,t,a){"use strict";var i=a("AccR");a.n(i).a},AccR:function(e,t,a){},NoVw:function(e,t,a){"use strict";a.r(t);var i=a("ViDN"),r=(a("KTTK"),a("utuE")),o=a("d8QR"),s={components:{CreateView:i.a,membersDep:r.a},data:function(){return{formList:[{label:"公告标题",field:"title"},{label:"通知部门",field:"dep",type:"plus"},{label:"开始时间",field:"startTime",type:"date"},{label:"结束时间",field:"endTime",type:"date"},{label:"公告正文",field:"content",type:"textarea"}],formData:{dep:{staff:[],dep:[]}},rules:{title:[{required:!0,message:"公告标题不能为空",trigger:"blur"},{max:50,message:"公告标题长度最多为50个字符",trigger:"blur"}],content:[{required:!0,message:"公告正文不能为空",trigger:"blur"}]},loading:!1}},methods:{onSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;e.loading=!0,Object(o.a)({title:e.formData.title,content:e.formData.content,startTime:e.formData.startTime,endTime:e.formData.endTime,deptIds:e.formData.dep.dep.map(function(e){return e.id}).join(","),ownerUserIds:e.formData.dep.staff.map(function(e){return e.userId}).join(",")}).then(function(t){e.$message.success("新建公告成功"),1==e.$route.query.routerKey?e.$router.push("notice"):e.$emit("onSubmit"),e.loading=!1}).catch(function(t){e.$message.error("新建公告失败"),e.loading=!1})})},close:function(){1==this.$route.query.routerKey?this.$router.go(-1):this.$emit("close")},popoverSubmit:function(e,t){this.$set(this.formData,"dep",{staff:e,dep:t})},deleteuser:function(e){this.formData.dep.staff.splice(e,1)},deleteDepuser:function(e){this.formData.dep.dep.splice(e,1)}}},n=(a("/0c0"),a("ZrdR")),l=Object(n.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("create-view",{attrs:{"body-style":{height:"100%"}}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"details-box"},[i("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[i("span",{staticClass:"text"},[e._v("新建公告")]),e._v(" "),i("img",{staticClass:"el-icon-close rt",attrs:{src:a("cjwK"),alt:""},on:{click:e.close}})]),e._v(" "),i("div",{staticClass:"content"},[i("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules}},e._l(e.formList,function(t,a){return i("el-form-item",{key:a,class:"el-form-item"+t.field,attrs:{label:t.label,prop:t.field}},["date"==t.type?[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.formData[t.field],callback:function(a){e.$set(e.formData,t.field,a)},expression:"formData[item.field]"}})]:"textarea"==t.type?[i("el-input",{attrs:{type:"textarea",autosize:{minRows:6},placeholder:"请输入内容"},model:{value:e.formData[t.field],callback:function(a){e.$set(e.formData,t.field,a)},expression:"formData[item.field]"}})]:"plus"==t.type?[i("members-dep",{attrs:{popoverDisplay:"block",title:"通知部门",userCheckedData:e.formData[t.field].staff,depCheckedData:e.formData[t.field].dep},on:{popoverSubmit:e.popoverSubmit}},[i("flexbox",{staticClass:"user-container",attrs:{slot:"membersDep",wrap:"wrap"},slot:"membersDep"},[e._l(e.formData[t.field].staff,function(t,a){return i("div",{key:"user"+a,staticClass:"user-item",on:{click:function(t){t.stopPropagation(),e.deleteuser(a)}}},[e._v(e._s(t.realname)+"\n                  "),i("i",{staticClass:"delete-icon el-icon-close"})])}),e._v(" "),e._l(e.formData[t.field].dep,function(t,a){return i("div",{key:"dep"+a,staticClass:"user-item",on:{click:function(t){t.stopPropagation(),e.deleteDepuser(a)}}},[e._v(e._s(t.name)+"\n                  "),i("i",{staticClass:"delete-icon el-icon-close"})])}),e._v(" "),i("div",{staticClass:"add-item"},[e._v("+添加")])],2)],1)]:i("el-input",{model:{value:e.formData[t.field],callback:function(a){e.$set(e.formData,t.field,a)},expression:"formData[item.field]"}})],2)}))],1),e._v(" "),i("div",{staticClass:"btn-box"},[i("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")]),e._v(" "),i("el-button",{on:{click:e.close}},[e._v("取消")])],1)])])},[],!1,null,"6680908b",null);l.options.__file="newDialog.vue";t.default=l.exports},d8QR:function(e,t,a){"use strict";a.d(t,"c",function(){return r}),a.d(t,"a",function(){return o}),a.d(t,"b",function(){return s});var i=a("t3Un");function r(e){return Object(i.a)({url:"OaAnnouncement/queryList",method:"post",data:e})}function o(e){return Object(i.a)({url:"OaAnnouncement/saveAndUpdate",method:"post",data:e})}function s(e){return Object(i.a)({url:"OaAnnouncement/delete",method:"post",data:e})}}}]);