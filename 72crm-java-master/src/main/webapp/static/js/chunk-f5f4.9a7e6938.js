(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-f5f4","chunk-2ce5","chunk-26b2","chunk-2ce5c","chunk-82a4","chunk-2ce5c5","chunk-d2ee","chunk-2ce5c57","chunk-a8c9"],{"+9th":function(t,e,a){"use strict";a.d(e,"k",function(){return i}),a.d(e,"a",function(){return n}),a.d(e,"d",function(){return l}),a.d(e,"e",function(){return o}),a.d(e,"g",function(){return c}),a.d(e,"h",function(){return r}),a.d(e,"b",function(){return d}),a.d(e,"f",function(){return u}),a.d(e,"c",function(){return m}),a.d(e,"j",function(){return h}),a.d(e,"i",function(){return p});var s=a("t3Un");function i(t){return Object(s.a)({url:"task/queryTaskList",method:"post",data:t})}function n(t){return Object(s.a)({url:"task/setTask",method:"post",data:t})}function l(t){return Object(s.a)({url:"task/deleteTask",method:"post",data:t})}function o(t){return Object(s.a)({url:"task/queryTaskInfo",method:"post",data:t})}function c(t){return Object(s.a)({url:"task/setTask",method:"post",data:t})}function r(t){return Object(s.a)({url:"task/svaeTaskRelation",method:"post",data:t})}function d(t){return Object(s.a)({url:"task/setLable",method:"post",data:t})}function u(t){return Object(s.a)({url:"task/setLable",method:"post",data:t})}function m(t){return Object(s.a)({url:"task/deleteLable",method:"post",data:t})}function h(t){return Object(s.a)({url:"task/getLableList",method:"post",data:t})}function p(t){return Object(s.a)({url:"task/queryWorkTaskLog",method:"post",data:t})}},"+Gvz":function(t,e,a){"use strict";a.r(e);var s=a("rerW"),i=a.n(s),n=a("bS4n"),l=a.n(n),o=a("+9th"),c=a("vPra"),r=a("KTTK"),d=a("utuE"),u={data:function(){return{colorList:["#53D397","#20C1BD","#58DADA","#0FC9E7","#3498DB","#4586FF","#8983F3","#AEA1EA","#FF6699","#F24D70","#FF6F6F"],input:this.newTagInput,showBgColor:""}},watch:{bgColorProps:function(t){this.showBgColor=t||"#53D397"}},props:{newTagTitle:String,newTagInput:String,bgColorProps:String},mounted:function(){this.showBgColor=this.bgColorProps||"#53D397"},methods:{back:function(){this.$emit("back")},close:function(){this.$emit("close")},changeColor:function(t){this.$emit("changeColor",t)},tagCreateSubmit:function(){this.$emit("tagCreateSubmit",this.input,this.showBgColor)},tagCancel:function(){this.$emit("tagCancel")}}},m=(a("fGWj"),a("ZrdR")),h=Object(m.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"new-tag-dialog"},[a("div",{staticClass:"title"},[a("span",{staticClass:"el-icon-arrow-left",on:{click:t.back}}),t._v(" "),a("span",[t._v(t._s(t.newTagTitle))]),t._v(" "),a("span",{staticClass:"el-icon-close rt",on:{click:t.close}})]),t._v(" "),a("div",{staticClass:"search"},[a("el-input",{attrs:{size:"mini",maxlength:10,placeholder:"输入标签名，最多十个字符"},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}}),t._v(" "),a("span",{staticClass:"checked-color",style:{background:t.showBgColor}})],1),t._v(" "),a("div",{staticClass:"color-box"},t._l(t.colorList,function(e,s){return a("span",{key:s,style:{background:e},on:{click:function(a){t.changeColor(e)}}})})),t._v(" "),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.tagCreateSubmit}},[t._v("保存")]),t._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:t.tagCancel}},[t._v("取消")])],1)])},[],!1,null,"27c006e2",null);h.options.__file="newTag.vue";var p=h.exports,v={data:function(){return{inputModel:"",list:this.editTagList}},props:{editTagList:Array},watch:{inputModel:function(t){this.list=this.editTagList.filter(function(e){return e.name.indexOf(t)>-1})}},methods:{back:function(){this.$emit("back")},close:function(){this.$emit("close")},deleteBtn:function(t){this.$emit("deleteBtn",t)},editBtn:function(t){this.$emit("editBtn",t)}}},f=(a("6K8m"),Object(m.a)(v,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"edit-tag-dialog"},[a("div",{staticClass:"title"},[a("span",{staticClass:"el-icon-arrow-left",on:{click:t.back}}),t._v(" "),a("span",[t._v("标签管理")]),t._v(" "),a("span",{staticClass:"el-icon-close rt",on:{click:t.close}})]),t._v(" "),a("div",{staticClass:"search"},[a("el-input",{attrs:{size:"mini",maxlength:10,placeholder:"输入标签名，最多十个字符"},model:{value:t.inputModel,callback:function(e){t.inputModel=e},expression:"inputModel"}})],1),t._v(" "),a("div",{staticClass:"content"},t._l(t.list,function(e,s){return a("div",{key:s,staticClass:"tag-list"},[a("span",{staticClass:"tag-name",style:{background:e.color?e.color:"#ccc"}},[t._v("\n        "+t._s(e.name.length>10?e.name.substring(0,10)+"...":e.name)+"\n      ")]),t._v(" "),a("div",{staticClass:"rt"},[a("span",{staticClass:"el-icon-edit",on:{click:function(a){t.editBtn(e)}}}),t._v(" "),a("span",{staticClass:"el-icon-delete",on:{click:function(a){t.deleteBtn(e)}}})])])}))])},[],!1,null,"eb99fe04",null));f.options.__file="editTag.vue";var g={components:{newTag:p,editTag:f.exports},data:function(){return{tagShow:!1,tagContent:0,tagInputChange:"",particularsTagList:[],newTagTitle:"",newTagInput:"",bgColorProps:"",editTagId:"",popoverWidth:"220"}},mounted:function(){this.tagListFun()},props:{taskData:{type:Object,default:function(){return{}}},placement:String},watch:{tagInputChange:function(t){this.particularsTagList=this.particularsTagListCopy.filter(function(e){return e.name.indexOf(t)>-1})}},methods:{createTagFun:function(){this.newTagTitle="创建新标签",this.newTagInput="",this.tagContent=1,this.popoverWidth="330"},editBtn:function(t){this.editTagId=t.lableId,this.newTagTitle="编辑标签",this.tagContent=3,this.bgColorProps=t.color,this.newTagInput=t.name},managementTag:function(){this.popoverWidth="400",this.tagContent=2},tagBtn:function(t,e){var a=this,s=e.filter(function(e){return t.check?e.check&&e.lableId!=t.lableId:e.check||e.lableId==t.lableId});for(var i in t.check?Object(o.g)({taskId:this.taskData.taskId,lableId:s.map(function(t){return t.lableId}).join(",")}).then(function(e){var s=a.taskData.labelList;for(var i in s)if(t.lableId==s[i].lableId){s.splice(i,1);break}t.check=!1}):Object(o.g)({taskId:this.taskData.taskId,lableId:s.map(function(t){return t.lableId}).join(",")}).then(function(e){t.check=!0,t.lableName=t.name,a.taskData.labelList.push(t)}),e)e[i].lableId==t.lableId?document.getElementsByClassName("tag-list")[i].style.background="#F7F8FA":document.getElementsByClassName("tag-list")[i].style.background="#FFF"},changeColor:function(t){this.bgColorProps=t},tagClose:function(){this.tagShow=!1},tagCreateSubmit:function(t,e){var a=this,s=this;"创建新标签"==this.newTagTitle?Object(o.b)({name:t,color:e}).then(function(t){a.tagClose(),a.tagListFun(),a.$message.success("创建成功")}):Object(o.f)({name:t,lableId:this.editTagId,color:e}).then(function(n){var l=!0,o=!1,c=void 0;try{for(var r,d=i()(s.editTagList);!(l=(r=d.next()).done);l=!0){var u=r.value;u.lableId==s.editTagId&&(u.name=t,u.color=e)}}catch(t){o=!0,c=t}finally{try{!l&&d.return&&d.return()}finally{if(o)throw c}}a.tagContent=2})},tagCancel:function(){"创建新标签"==this.newTagTitle?(this.tagClose(),this.$message.info("已取消创建")):this.tagContent=2},back:function(){"创建新标签"==this.newTagTitle?(this.tagContent=0,this.popoverWidth="220"):"编辑标签"==this.newTagTitle&&3==this.tagContent?this.tagContent=2:2==this.tagContent&&(this.tagContent=0,this.popoverWidth="220")},deleteBtn:function(t){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){e.tagShow=!0,e.managementTag(),Object(o.c)({lableId:t.lableId}).then(function(a){for(var s in e.editTagList)e.editTagList[s].lableId==t.lableId&&e.editTagList.splice(s,1);e.$message({type:"success",message:"删除成功!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"}),e.tagShow=!0,e.managementTag()})},tagListFun:function(){var t=this;Object(o.j)().then(function(e){var a=!0,s=!1,n=void 0;try{for(var l,o=i()(e.data);!(a=(l=o.next()).done);a=!0){var c=l.value;if(t.taskData.labelList){var r=!0,d=!1,u=void 0;try{for(var m,h=i()(t.taskData.labelList);!(r=(m=h.next()).done);r=!0){if(m.value.lableId==c.lableId){c.check=!0;break}c.check=!1}}catch(t){d=!0,u=t}finally{try{!r&&h.return&&h.return()}finally{if(d)throw u}}}}}catch(t){s=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(s)throw n}}t.editTagList=e.data,t.particularsTagList=e.data,t.particularsTagListCopy=e.data})},referenceFun:function(){this.tagContent=0,this.tagListFun()}}},b=(a("nd7A"),Object(m.a)(g,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"edit-index"},[a("el-popover",{attrs:{placement:t.placement,width:t.popoverWidth,trigger:"click"},model:{value:t.tagShow,callback:function(e){t.tagShow=e},expression:"tagShow"}},[0==t.tagContent?a("div",{staticClass:"tag-popover-box"},[a("div",{staticClass:"tag-top"},[a("span",[t._v("选择标签")]),t._v(" "),a("span",{staticClass:"el-icon-close rt cursor-pointer",on:{click:function(e){t.tagShow=!1}}})]),t._v(" "),a("el-input",{attrs:{placeholder:"搜索标签","prefix-icon":"el-icon-search",size:"small"},model:{value:t.tagInputChange,callback:function(e){t.tagInputChange=e},expression:"tagInputChange"}}),t._v(" "),a("div",{staticClass:"tag-content"},t._l(t.particularsTagList,function(e,s){return a("div",{key:s,staticClass:"tag-list",on:{click:function(a){t.tagBtn(e,t.particularsTagList)}}},[a("i",{staticClass:"wukong wukong-black-label",style:{color:e.color}}),t._v(" "),a("span",{staticClass:"item-label"},[t._v(t._s(e.name))]),t._v(" "),e.check?a("span",{staticClass:"el-icon-check rt"}):t._e()])})),t._v(" "),a("div",{staticClass:"tag-footer"},[a("p",{staticClass:"footer-row cursor-pointer",on:{click:t.createTagFun}},[a("span",{staticClass:"el-icon-plus"}),t._v(" "),a("span",[t._v("创建新标签")])]),t._v(" "),a("p",{staticClass:"footer-row cursor-pointer",on:{click:t.managementTag}},[a("span",{staticClass:"el-icon-setting"}),t._v(" "),a("span",[t._v("标签管理")])])])],1):1==t.tagContent?a("new-tag",{attrs:{newTagTitle:t.newTagTitle,newTagInput:t.newTagInput,bgColorProps:t.bgColorProps},on:{changeColor:t.changeColor,close:t.tagClose,tagCreateSubmit:t.tagCreateSubmit,tagCancel:t.tagCancel,back:t.back}}):2==t.tagContent?a("editTag",{attrs:{editTagList:t.editTagList},on:{back:t.back,close:t.tagClose,editBtn:t.editBtn,deleteBtn:t.deleteBtn}}):3==t.tagContent?a("new-tag",{attrs:{newTagTitle:t.newTagTitle,newTagInput:t.newTagInput,bgColorProps:t.bgColorProps},on:{changeColor:t.changeColor,close:t.tagClose,tagCreateSubmit:t.tagCreateSubmit,tagCancel:t.tagCancel,back:t.back}}):t._e(),t._v(" "),a("span",{attrs:{slot:"reference"},on:{click:t.referenceFun},slot:"reference"},[t._t("editIndex")],2)],1)],1)},[],!1,null,"4c57ea9e",null));b.options.__file="tagIndex.vue";var k=b.exports,y=a("omC7"),C=a.n(y),_=a("0hym"),w={components:{XhUser:_.a},data:function(){return{subtasksDate:"",xhUserData:[],subtasksDataText:null,subtaskChange:!1,num:0,subtasksTextarea:"",isNum:0}},created:function(){"edit"==this.subTaskCom&&(this.subtasksTextarea=this.text?this.text:"",this.subtasksDataText=this.time,"{}"!==C()(this.subData)?this.subData.mainUser&&(this.subtaskChange=!0,this.xhUserData=[this.subData.mainUser]):(this.xhUserData=[],this.subtaskChange=!1))},props:{taskData:{type:Object,default:function(){return{}}},text:String,time:[String,Number],subData:Object,subTaskCom:{type:String,default:""},taskId:[Number,String],checkboxData:{type:Boolean,default:!1}},watch:{},methods:{subtasksDateClick:function(t){this.subtasksDataText=t.substring(5)},subtasksSubmit:function(t){var e=this;this.subtasksTextarea=this.subtasksTextarea.split(/[\n]/).join(""),this.subtasksTextarea&&0==this.num?(this.num=1,"new"==this.subTaskCom?(this.$emit("on-handle",{type:"add",result:"success"}),Object(o.a)({pid:this.taskData.taskId,name:this.subtasksTextarea,stopTime:this.subtasksDate,mainUserId:0!=this.xhUserData.length?this.xhUserData[0].userId:""}).then(function(t){e.taskData.childTask.push({name:e.subtasksTextarea,stopTime:e.subtasksDate,taskId:t.data.taskId,mainUser:e.xhUserData.length>0?e.xhUserData[0]:null}),e.$message.success("子任务创建成功"),e.subtasksTextarea="",e.subtasksDataText=null,e.subtaskChange=!1,e.num=0}).catch(function(t){e.$emit("on-handle",{type:"add",result:"error"}),e.$message.error("子任务创建失败"),e.num=0})):"edit"==this.subTaskCom&&(1==this.isNum||this.text!=this.subtasksTextarea||this.subtasksDataText!=this.time?(this.$emit("on-handle",{type:"edit",result:"success"}),Object(o.g)({taskId:this.taskId,stopTime:this.subtasksDate,mainUserId:this.xhUserData.length>0?this.xhUserData[0].id:"",name:this.subtasksTextarea}).then(function(t){var a=e.taskData.childTask;for(var s in a)if(a[s].taskId==e.taskId){var i=a[s];i.name=e.subtasksTextarea,i.stopTime=e.subtasksDate,i.mainUser=e.xhUserData.length>0?e.xhUserData[0]:null,a.splice(s,1,i);break}e.num=0,e.$message.success("子任务编辑成功")}).catch(function(t){e.$emit("on-handle",{type:"edit",result:"error"}),e.$message.error("子任务编辑失败"),e.num=0})):this.$emit("on-handle",{type:"cancel"}))):this.$emit("on-handle",{type:"cancel"})},xhUserCheckout:function(t){0!=t.data.length?(this.subtaskChange=!0,0!=this.xhUserData.length?(this.$set(this.xhUserData[0],"img",t.data[0].img),this.$set(this.xhUserData[0],"realname",t.data[0].realname)):this.xhUserData=t.data,this.isNum=1):(this.isNum=0,this.subtaskChange=!1)},subtasksDateFun:function(){this.$refs.subtasksDate.change()}}},x=(a("X+yC"),Object(m.a)(w,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-sub"},[a("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.subtasksSubmit,expression:"subtasksSubmit"}],staticClass:"subtasks-content"},[a("div",{staticClass:"checkbox-box subtasks-box"},[a("el-checkbox",{attrs:{disabled:""},model:{value:t.checkboxData,callback:function(e){t.checkboxData=e},expression:"checkboxData"}})],1),t._v(" "),a("div",{staticClass:"subtasks-content-box"},[a("el-input",{attrs:{type:"textarea",autosize:"",maxlength:50,placeholder:"请输入内容"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.subtasksSubmit(e):null}},model:{value:t.subtasksTextarea,callback:function(e){t.subtasksTextarea=e},expression:"subtasksTextarea"}})],1),t._v(" "),a("flexbox",{staticClass:"subtasks-content-png"},[a("div",{staticClass:"time"},[a("el-date-picker",{ref:"subtasksDate",style:{width:t.subtasksDataText?"54px":"28px"},attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:function(e){t.subtasksDateClick(t.subtasksDate)}},model:{value:t.subtasksDate,callback:function(e){t.subtasksDate=e},expression:"subtasksDate"}}),t._v(" "),t.subtasksDataText&&0!=t.subtasksDataText?a("span",{staticClass:"bg-color"},[t._v(t._s(t._f("moment")(t.subtasksDataText,"MM-DD")))]):a("i",{staticClass:"wukong wukong-time-task",on:{click:t.subtasksDateFun}})],1),t._v(" "),a("el-popover",{attrs:{placement:"bottom-end",width:"280",trigger:"click"}},[a("xh-user",{ref:"xhuser",attrs:{radio:"",selectedData:t.xhUserData},on:{changeCheckout:t.xhUserCheckout}}),t._v(" "),a("div",{staticClass:"select-box",attrs:{slot:"reference"},slot:"reference"},[t.subtaskChange?t._l(t.xhUserData,function(e,s){return a("span",{key:s},[a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(e.realname))])]),t._v(" "),a("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"item"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.img),expression:"$options.filters.filterUserLazyImg(item.img)",arg:"background-image"}],staticClass:"div-photo"})])],1)}):a("i",{staticClass:"wukong wukong-user"})],2)],1)],1)],1)])},[],!1,null,"4586fff5",null));x.options.__file="subTask.vue";var I=x.exports,D=a("S3Kq"),T=a("1RnH"),L=a("O1Uw"),A=a("uMjE"),R=a("8t5x"),j=a("7Qib"),E={components:{membersDep:d.a,emoji:D.a,relatedBusiness:T.a,XhUser:_.a,tagIndex:k,CRMFullScreenDetail:A.default,subTask:I,FileCell:L.a},data:function(){return{zIndex:Object(j.g)(),commentsActivities:!0,commentsTextarea:"",childCommentsTextarea:"",replyChildComment:null,replyChildIndex:-1,contentLoading:!1,commentsPopover:!1,childCommentsPopover:!1,priorityVisible:!1,particularsList:[{id:3,label:"高",color:"#ED6363"},{id:2,label:"中",color:"#FF9668"},{id:1,label:"低",color:"#8bb5f0"},{id:0,label:"无",color:"#ccc"}],addSubtasks:!0,nameVinput:!1,taskDataName:"",addDescriptionShow:!1,addDescriptionTextarea:"",subTaskProgress:0,blurIndex:0,addComments:!1,allData:{},isComment:!0,commentsLoading:!1,relatedID:"",relatedCRMType:"",showRelatedDetail:!1,subTaskID:null,loading:!1,taskData:null,activityList:[],fileList:[],replyList:[]}},props:{id:[String,Number],detailIndex:Number,appendToBody:{type:Boolean,default:!1}},computed:l()({},Object(R.b)(["userInfo"])),watch:{id:function(t){this.initInfo(),this.getDetail(),this.getActivityList(),this.getCommentList()}},mounted:function(){this.appendToBody&&document.body.appendChild(this.$el),this.id&&(this.getDetail(),this.getActivityList(),this.getCommentList())},methods:{initInfo:function(){this.taskData=null,this.subTaskProgress=0,this.allData={business:[],contacts:[],contract:[],customer:[]},this.taskData=null,this.activityList=[],this.fileList=[]},getDetail:function(){var t=this;this.loading=!0,Object(o.e)({taskId:this.id}).then(function(e){var a=e.data;if(a.checked=5==a.status,a.childTask){var s=!0,n=!1,l=void 0;try{for(var o,c=i()(a.childTask);!(s=(o=c.next()).done);s=!0){var r=o.value;5==r.status?(r.checked=!0,t.subTaskProgress++):r.checked=!1}}catch(t){n=!0,l=t}finally{try{!s&&c.return&&c.return()}finally{if(n)throw l}}}t.fileList=e.data.file,t.allData={business:a.businessList||[],contacts:a.contactsList||[],contract:a.contractList||[],customer:a.customerList||[]},t.taskData=a,t.loading=!1}).catch(function(e){t.loading=!1,t.closeBtn()})},getActivityList:function(){var t=this;Object(o.i)({taskId:this.id}).then(function(e){t.activityList=e.data}).catch(function(){})},getCommentList:function(){var t=this;Object(c.b)({typeId:this.id,type:1}).then(function(e){t.replyList=e.data}).catch(function(){})},titleCheckbox:function(t){var e=this;this.taskData.checked=t,Object(o.g)({taskId:this.id,type:this.taskData.checked?1:2}).then(function(a){e.$emit("on-handle",{type:"title-check",value:t,index:e.detailIndex})}).catch(function(t){e.$emit("on-handle",{type:"title-check",value:!e.taskData.checked,index:e.detailIndex}),e.taskData.checked=!e.taskData.checked})},closeBtn:function(){this.$emit("close")},footerTitle:function(t){switch(t){case 0:this.commentsActivities=!0,this.isComment=!0;break;case 1:this.commentsActivities=!1,this.isComment=!1}},priorityBtn:function(t,e){var a=this;this.taskData.priority=t.id,Object(o.g)({taskId:this.id,priority:t.id}).then(function(e){a.$emit("on-handle",{type:"change-priority",value:t,index:a.detailIndex}),a.priorityVisible=!1}).catch(function(t){a.$message.error("编辑失败"),a.taskData.priority=e})},moreDelete:function(){var t=this;this.$confirm("此操作将永久删除该任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){Object(o.d)({taskId:t.id}).then(function(e){t.$message.success("删除成功"),t.$emit("on-handle",{type:"delete",index:t.detailIndex}),t.$emit("close")}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},httpRequest:function(t){var e=this;Object(r.e)({file:t.file,batchId:this.taskData.batchId}).then(function(t){e.fileList.push(t),e.$message.success("上传成功")}).catch(function(){})},accessoryDeleteFun:function(t,e){this.fileList.splice(t,1)},addSubtasksBtn:function(){this.addSubtasks=!this.addSubtasks},subtasksCheckbox:function(t,e){var a=this;e?(this.$set(t,"checked",!0),this.subTaskProgress++):(this.$set(t,"checked",!1),this.subTaskProgress--),this.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:this.subTaskProgress,allcount:this.taskData.childTask.length},index:this.detailIndex}),Object(o.g)({taskId:t.taskId,status:e?5:1}).then(function(t){}).catch(function(s){a.$message.error("子任务标记失败"),e?(a.$set(t,"checked",!1),a.subTaskProgress--):(a.$set(t,"checked",!0),a.subTaskProgress++),a.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:a.subTaskProgress,allcount:a.taskData.childTask.length},index:a.detailIndex})})},editOwnerList:function(t,e){var a=this;this.taskData.ownerUserList=[],Object(o.g)({taskId:this.id,ownerUserId:t.map(function(t){return t.userId}).join(",")}).then(function(e){a.taskData.ownerUserList=t}).catch(function(){})},deleteOwnerList:function(t,e){var a=this;Object(o.g)({taskId:this.id,ownerUserId:this.taskData.ownerUserList.filter(function(e){return e.userId!=t.userId}).map(function(t){return t.userId}).join(",")}).then(function(t){a.taskData.ownerUserList.splice(e,1)}).catch(function(){})},editMainUser:function(t){var e=this;Object(o.g)({taskId:this.id,mainUserId:t?t.data[0].userId:""}).then(function(a){t?e.$set(e.taskData,"mainUser",t.data[0]):e.$set(e.taskData,"mainUser",null)}).catch(function(){})},nameVShow:function(t){var e=this;Object(o.g)({name:t,taskId:this.id}).then(function(a){e.nameVinput=!1,e.$emit("on-handle",{type:"change-name",value:t,index:e.detailIndex}),e.taskData.name=t}).catch(function(){})},endTimeChange:function(t){var e=this;Object(o.g)({stopTime:t,taskId:this.id}).then(function(a){e.$emit("on-handle",{type:"change-stop-time",value:new Date(t).getTime()/1e3,index:e.detailIndex})}).catch(function(){})},addDescriptionSubmit:function(){var t=this;Object(o.g)({taskId:this.id,description:this.addDescriptionTextarea}).then(function(e){t.addDescriptionShow=!1,t.$set(t.taskData,"description",t.addDescriptionTextarea)}).catch(function(){})},selectEmoji:function(t){var e=this.commentsTextarea.split("");e.splice(this.blurIndex,0,t),this.commentsTextarea=e.join(""),this.commentsPopover=!1},selectEmojiChild:function(t){var e=this.childCommentsTextarea.split("");e.splice(this.blurIndex,0,t),this.childCommentsTextarea=e.join(""),this.childCommentsPopover=!1},commentsSub:function(){var t=this;this.commentsTextarea&&(this.commentsLoading=!0,Object(c.c)({typeId:this.id,type:1,content:this.commentsTextarea}).then(function(e){e.data.childCommentList=[],e.data.show=!1,e.data.user=t.userInfo,t.replyList.push(e.data),t.commentsTextarea="",t.$emit("on-handle",{type:"change-comments",value:"add",index:t.detailIndex}),t.commentsLoading=!1}).catch(function(e){t.commentsLoading=!1}))},childCommentSubmit:function(){var t=this;if(this.replyChildComment&&this.childCommentsTextarea){var e=-1==this.replyChildIndex?this.replyChildComment:this.replyChildComment.childCommentList[this.replyChildIndex];Object(c.c)({pid:e.userId,typeId:e.typeId,mainId:0==e.mainId?e.commentId:e.mainId,type:1,content:this.childCommentsTextarea}).then(function(a){t.childCommentsPopover=!1,a.data.user=t.userInfo,a.data.replyUser=e.user,t.replyChildComment.childCommentList.push(a.data),t.replyChildComment.show=!1,t.replyChildComment=null,t.childCommentsTextarea="",t.$emit("on-handle",{type:"change-comments",value:"add",index:t.detailIndex})}).catch(function(){})}},discussDelete:function(t,e,a){var s=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){Object(c.a)({commentId:t.commentId}).then(function(t){e.splice(a,1),s.$emit("on-handle",{type:"change-comments",value:"delete",index:s.detailIndex})}).catch(function(){})}).catch(function(){s.$message({type:"info",message:"已取消删除"})})},discussBtn:function(t,e){t.show?(this.$set(t,"show",!1),this.replyChildComment=null):(this.$set(t,"show",!0),this.$set(t,"showComment",!1),this.replyChildComment=t,this.replyChildIndex=e)},blurFun:function(t){this.blurIndex=t.target.selectionEnd},checkInfos:function(t){var e=this;Object(o.h)({taskId:this.id,customerIds:t.customerIds&&t.customerIds.length?","+t.customerIds.join(",")+",":"",contactsIds:t.contactsIds&&t.contactsIds.length?","+t.contactsIds.join(",")+",":"",businessIds:t.businessIds&&t.businessIds.length?","+t.businessIds.join(",")+",":"",contractIds:t.contractIds&&t.contractIds.length?","+t.contractIds.join(",")+",":""}).then(function(t){e.$message.success("关联成功")}).catch(function(){})},commentsSubmit:function(t){this.addComments=!1},checkRelatedDetail:function(t,e){this.relatedID=e.key,this.relatedCRMType=t,this.showRelatedDetail=!0},deleteSubTask:function(t){var e=this;this.$confirm("此操作将永久删除该任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){Object(o.d)({taskId:t.taskId}).then(function(a){var s=e.taskData.childTask;for(var i in s)if(s[i].taskId==t.taskId){s.splice(i,1);break}t.checked&&(e.subTaskProgress--,e.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:e.subTaskProgress,allcount:e.taskData.childTask.length},index:e.detailIndex})),e.$message.success("子任务删除成功")}).catch(function(t){e.$message.error("子任务删除失败")})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},editSubTask:function(t){this.subTaskID=t.taskId;var e=this.taskData.childTask;for(var a in e)e[a].taskId==t.taskId?this.$set(e[a],"showEdit",!0):this.$set(e[a],"showEdit",!1)},handleSubTasksBlock:function(t,e){"edit"==t.type?this.$set(e,"showEdit",!1):"add"==t.type?(this.addSubtasks=!0,"success"==t.result?this.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:this.subTaskProgress,allcount:this.taskData.childTask.length+1},index:this.detailIndex}):this.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:this.subTaskProgress,allcount:this.taskData.childTask.length-1},index:this.detailIndex})):"cancel"==t.type&&(e?this.$set(e,"showEdit",!1):this.addSubtasks=!0)},deleteTimeTop:function(){var t=this;Object(o.g)({taskId:this.id,stopTime:""}).then(function(e){t.$set(t.taskData,"stopTime","")}).catch(function(){})}},beforeDestroy:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},M=(a("nbhK"),Object(m.a)(E,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"slide-fade"}},[s("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"particulars-common",style:{"z-index":t.zIndex}},[t.taskData?s("div",{staticClass:"clear-fix",attrs:{slot:"header"},slot:"header"},[s("div",{staticClass:"img-box-grop"},[s("div",[s("el-popover",{attrs:{placement:"bottom-start",width:"200",trigger:"click"},model:{value:t.priorityVisible,callback:function(e){t.priorityVisible=e},expression:"priorityVisible"}},[s("div",{staticClass:"particulars-priority-box"},t._l(t.particularsList,function(e,a){return s("p",{key:a,on:{click:function(a){t.priorityBtn(e,t.taskData.priority)}}},[s("span",{style:{"border-color":e.color,background:e.id==t.taskData.priority?e.color:"transparent",color:e.id==t.taskData.priority?"#fff":e.color}},[t._v(t._s(e.label))])])})),t._v(" "),s("span",{attrs:{slot:"reference"},slot:"reference"},[s("i",{staticClass:"wukong wukong-lightning"}),t._v(" "),s("span",[t._v("优先级")])])])],1),t._v(" "),s("div",[s("tag-index",{attrs:{placement:"bottom",taskData:t.taskData}},[s("div",{attrs:{slot:"editIndex"},slot:"editIndex"},[s("i",{staticClass:"wukong wukong-label"}),t._v(" "),s("span",[t._v("标签")])])])],1),t._v(" "),0==t.taskData.pid?s("div",{on:{click:t.addSubtasksBtn}},[s("i",{staticClass:"wukong wukong-sub-task"}),t._v(" "),s("span",[t._v("子任务")])]):t._e(),t._v(" "),s("div",[s("el-upload",{staticClass:"upload-demo",attrs:{action:"https://jsonplaceholder.typicode.com/posts/",multiple:"","http-request":t.httpRequest,"list-type":"picture"}},[s("i",{staticClass:"wukong wukong-file"}),t._v(" "),s("span",[t._v("附件")])])],1),t._v(" "),s("div",[s("el-popover",{attrs:{placement:"bottom",width:"80",trigger:"click"}},[s("div",{staticClass:"more-btn-group"},[s("p",{on:{click:t.moreDelete}},[t._v("删 除")])]),t._v(" "),s("span",{attrs:{slot:"reference"},slot:"reference"},[s("img",{attrs:{src:a("DcnZ")}})])])],1),t._v(" "),s("div",{staticClass:"task-close-img"},[s("img",{attrs:{src:a("cjwK")},on:{click:t.closeBtn}})])])]):t._e(),t._v(" "),t.taskData?s("div",{staticClass:"body-content"},[t._t("extraContent"),t._v(" "),s("div",{staticClass:"card-content-box"},[s("el-checkbox",{on:{change:t.titleCheckbox},model:{value:t.taskData.checked,callback:function(e){t.$set(t.taskData,"checked",e)},expression:"taskData.checked"}}),t._v(" "),s("div",{staticClass:"card-content"},[s("div",{staticClass:"card-content-row margin-bottom-15"},[s("div",{staticClass:"priority-data-name"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.nameVinput,expression:"!nameVinput"}],staticClass:"title-text",style:{"text-decoration":t.taskData.checked?"line-through":"none"}},[t._v("\n                "+t._s(t.taskData.name)+"\n                "),s("span",{staticClass:"el-icon-edit-outline",on:{click:function(e){t.nameVinput=!0,t.taskDataName=t.taskData.name}}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.nameVinput,expression:"nameVinput"}],staticClass:"show-input"},[s("el-input",{attrs:{maxlength:50,size:"medium"},model:{value:t.taskDataName,callback:function(e){t.taskDataName=e},expression:"taskDataName"}}),t._v(" "),s("div",{staticClass:"btn-box"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.nameVShow(t.taskDataName)}}},[t._v("保 存")]),t._v(" "),s("el-button",{attrs:{size:"mini"},on:{click:function(e){t.nameVinput=!1}}},[t._v("取 消")])],1)],1)]),t._v(" "),s("div",{staticClass:"card-row-right"},[s("flexbox",{staticClass:"text-right"},[s("div",{staticClass:"color-label user-name-label"},[t._v(" 负责人： ")]),t._v(" "),t.taskData.mainUser?s("div",{staticClass:"bg-position"},[s("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("span",[t._v(t._s(t.taskData.mainUser.realname))])]),t._v(" "),s("div",{directives:[{name:"photo",rawName:"v-photo",value:t.taskData.mainUser,expression:"taskData.mainUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.taskData.mainUser.img),expression:"$options.filters.filterUserLazyImg(taskData.mainUser.img)",arg:"background-image"}],staticClass:"div-photo main-user-name"})]),t._v(" "),s("img",{staticClass:"el-icon-close",attrs:{src:a("cEue"),alt:""},on:{click:function(e){t.editMainUser("")}}})],1):[s("el-popover",{attrs:{placement:"bottom",width:"280",trigger:"click"}},[s("xh-user",{ref:"xhuser",attrs:{radio:""},on:{changeCheckout:t.editMainUser}}),t._v(" "),s("i",{staticClass:"wukong wukong-addition-task",attrs:{slot:"reference"},slot:"reference"})],1)]],2)],1)]),t._v(" "),t.taskData.labelList?s("div",{staticClass:"card-content-row  margin-bottom-25"},[s("div",{staticClass:"particulars-priority-copy"},[t._l(t.taskData.labelList,function(e,a){return s("span",{key:a,staticClass:"item-color",style:{background:e.color?e.color:"#ccc"}},[t._v("\n                  "+t._s(e.lableName)+"\n                ")])}),t._v(" "),s("div",{staticClass:"add-tag"},[s("tag-index",{attrs:{placement:"right",taskData:t.taskData}},[s("div",{attrs:{slot:"editIndex"},slot:"editIndex"},[s("span",{staticClass:"el-icon-plus"}),t._v(" "),s("span",{staticClass:"label"},[t._v("添加标签")])])])],1)],2),t._v(" "),s("div",{staticClass:"card-row-right"},[s("div",{staticClass:"text-right"},[s("span",{staticClass:"color-label"},[t._v(" 截止日期： ")]),t._v(" "),s("div",{staticClass:"time-top"},[s("el-date-picker",{ref:"endTime",class:{"no-time-top":!t.taskData.stopTime},attrs:{type:"date",clearable:!1,"value-format":"yyyy-MM-dd",placeholder:""},on:{change:t.endTimeChange},model:{value:t.taskData.stopTime,callback:function(e){t.$set(t.taskData,"stopTime",e)},expression:"taskData.stopTime"}}),t._v(" "),t.taskData.stopTime?s("img",{staticClass:"el-icon-close time-top-close",attrs:{src:a("cEue"),alt:""},on:{click:function(e){e.stopPropagation(),t.deleteTimeTop(t.taskData.stopTime)}}}):t._e()],1)])])]):t._e(),t._v(" "),s("div",{staticClass:"add-description"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.addDescriptionShow,expression:"!addDescriptionShow"}]},[t.taskData.description?s("div",{on:{click:function(e){t.addDescriptionShow=!0,t.addDescriptionTextarea=t.taskData.description}}},[t._v("\n                "+t._s(t.taskData.description)+"\n              ")]):s("div",{staticClass:"no-description"},[s("span",{staticClass:"color-label"},[t._v("暂无描述")]),t._v(" "),s("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){t.addDescriptionShow=!0}}},[t._v("添加描述")])],1)]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.addDescriptionShow,expression:"addDescriptionShow"}]},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2},maxlength:"50",placeholder:"请输入内容"},model:{value:t.addDescriptionTextarea,callback:function(e){t.addDescriptionTextarea=e},expression:"addDescriptionTextarea"}}),t._v(" "),s("div",{staticClass:"btn-box"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.addDescriptionSubmit}},[t._v("保 存")]),t._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){t.addDescriptionShow=!1}}},[t._v("取 消")])],1)],1)]),t._v(" "),s("div",{staticClass:"card-content-row card-content-row-column"},[s("flexbox",[s("div",{staticClass:"color-label participant"},[s("i",{staticClass:"wukong wukong-user"}),t._v(" "),s("span",[t._v("参与人： ")])]),t._v(" "),t.taskData.ownerUserList?s("div",{staticClass:"participant-class"},t._l(t.taskData.ownerUserList,function(e,i){return s("span",{key:i,staticClass:"owner-list"},[s("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("span",[t._v(t._s(e.realname))])]),t._v(" "),s("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"item"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.img),expression:"$options.filters.filterUserLazyImg(item.img)",arg:"background-image"}],staticClass:"div-photo item-img"})]),t._v(" "),s("img",{staticClass:"el-icon-close",attrs:{src:a("cEue")},on:{click:function(a){t.deleteOwnerList(e,i)}}})],1)})):t._e(),t._v(" "),s("members-dep",{attrs:{closeDep:!0,contentBlock:!1,userCheckedData:t.taskData.ownerUserList},on:{popoverSubmit:t.editOwnerList}},[s("i",{staticClass:"wukong wukong-addition-task",attrs:{slot:"membersDep"},slot:"membersDep"})])],1)],1),t._v(" "),s("div",{staticClass:"card-content-row card-content-row-column margin-bottom-30"},[s("span",{staticClass:"color-label participant"},[s("i",{staticClass:"wukong wukong-relevance"}),t._v(" "),s("span",[t._v("关联业务")])]),t._v(" "),s("related-business",{attrs:{marginLeft:"0",isTask:!0,allData:t.allData,taskID:t.taskData.taskId},on:{checkRelatedDetail:t.checkRelatedDetail,checkInfos:t.checkInfos}})],1),t._v(" "),s("div",{staticClass:"card-content-row card-content-row-column"},[s("div",{staticClass:"display-flex sub-task margin-bottom-7"},[s("span",{staticClass:"color-label participant"},[s("i",{staticClass:"wukong wukong-sub-task"}),t._v(" "),s("span",[t._v("子任务")])]),t._v(" "),0!=t.taskData.childTask.length?[s("span",{staticClass:"color-label sub-task-progress"},[t._v(" ("+t._s(t.subTaskProgress)+"/"+t._s(t.taskData.childTask.length)+") ")]),t._v(" "),s("el-progress",{attrs:{percentage:t.subTaskProgress/t.taskData.childTask.length*100,"stroke-width":10}})]:[s("span",{staticClass:"color-label sub-task-progress"},[t._v(" ("+t._s(t.subTaskProgress)+"/"+t._s(t.taskData.childTask.length)+") ")]),t._v(" "),s("el-progress",{attrs:{percentage:0}})]],2),t._v(" "),0!=t.taskData.childTask.length?t._l(t.taskData.childTask,function(e,a){return s("div",{key:a,staticClass:"card-related-matters subtasks-box"},[e.showEdit?s("sub-task",{attrs:{subTaskCom:"edit",time:e.stopTime,subData:e,text:e.name,taskId:t.subTaskID,checkboxData:e.checked,taskData:t.taskData},on:{"on-handle":function(a){t.handleSubTasksBlock(a,e)}}}):s("div",{staticClass:"show-edit"},[s("div",{staticStyle:{display:"inline-block"},on:{click:function(t){t.stopPropagation()}}},[s("el-checkbox",{on:{change:function(a){t.subtasksCheckbox(e,a)}},model:{value:e.checked,callback:function(a){t.$set(e,"checked",a)},expression:"item.checked"}})],1),t._v(" "),s("span",{staticClass:"item-name",style:{"text-decoration":e.checked?"line-through":"none"}},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"edit-del-box"},[s("i",{staticClass:"wukong wukong-edit-task",on:{click:function(a){t.editSubTask(e)}}}),t._v(" "),s("i",{staticClass:"wukong wukong-delete-task",on:{click:function(a){t.deleteSubTask(e)}}})]),t._v(" "),s("div",{staticClass:"rt"},[s("flexbox",{staticClass:"rt-box"},[e.stopTime?s("div",{staticClass:"bg-color task-bg-color"},[t._v(t._s(t._f("moment")(e.stopTime,"MM-DD"))+" 截止")]):t._e(),t._v(" "),e.mainUser?s("div",{directives:[{name:"photo",rawName:"v-photo",value:e.mainUser,expression:"item.mainUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.mainUser.img),expression:"$options.filters.filterUserLazyImg(item.mainUser.img)",arg:"background-image"}],key:e.mainUser.img,staticClass:"div-photo"}):t._e()])],1)])],1)}):t._e(),t._v(" "),t.addSubtasks?s("div",{staticClass:"add-subtasks",on:{click:function(e){t.addSubtasks=!1}}},[s("span",{staticClass:"el-icon-plus"}),t._v(" "),s("span",[t._v("添加子任务")])]):s("sub-task",{attrs:{subTaskCom:"new",taskData:t.taskData},on:{"on-handle":t.handleSubTasksBlock}})],2),t._v(" "),0!=t.fileList.length?s("div",{staticClass:"card-content-row card-content-row-column"},[s("span",{staticClass:"color-label participant class-file"},[s("i",{staticClass:"wukong wukong-file"}),t._v(" "),s("span",[t._v("附件")])]),t._v(" "),s("div",{staticClass:"accessory-box"},t._l(t.fileList,function(e,a){return s("file-cell",{key:a,attrs:{data:e,cellIndex:a,module_id:t.id,showDelete:!0},on:{delete:t.accessoryDeleteFun}})}))]):t._e()])],1),t._v(" "),s("div",{staticClass:"border"}),t._v(" "),s("div",{staticClass:"card-footers"},[s("div",{staticClass:"footer-title"},[s("span",{on:{click:function(e){t.footerTitle(0)}}},[t.isComment?s("i",{staticClass:"wukong wukong-comment-task",staticStyle:{color:"#3E84E9"}}):s("i",{staticClass:"wukong wukong-comment-task"}),t._v(" "),s("span",{staticClass:"cursor-pointer",style:{color:t.isComment?"#3E84E9":"#666"}},[t._v("评论")])]),t._v(" "),s("span",{staticClass:"title-border"}),t._v(" "),s("span",{on:{click:function(e){t.footerTitle(1)}}},[t.isComment?s("i",{staticClass:"wukong wukong-activity-task",staticStyle:{"font-size":"18px"}}):s("i",{staticClass:"wukong wukong-activity-task",staticStyle:{color:"#3E84E9","font-size":"18px"}}),t._v(" "),s("span",{staticClass:"cursor-pointer",style:{color:t.isComment?"#666":"#3E84E9"},on:{click:function(e){t.footerTitle(t.isComment)}}},[t._v("活动")])])]),t._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.commentsLoading,expression:"commentsLoading"}],staticClass:"footer-content-box"},[s("div",{staticClass:"footer-content"},[t.commentsActivities?s("div",{staticClass:"add-comments"},[s("div",{staticClass:"footer-img"},[s("div",{directives:[{name:"photo",rawName:"v-photo",value:t.userInfo,expression:"userInfo"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.userInfo.img),expression:"$options.filters.filterUserLazyImg(userInfo.img)",arg:"background-image"}],staticClass:"div-photo"})]),t._v(" "),s("div",{staticClass:"comments-con"},[t.addComments?s("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.commentsSubmit,expression:"commentsSubmit"}],staticClass:"comments-box"},[s("el-input",{ref:"commentsTextareaRef",attrs:{type:"textarea",rows:4,placeholder:"添加评论"},on:{blur:t.blurFun},model:{value:t.commentsTextarea,callback:function(e){t.commentsTextarea=e},expression:"commentsTextarea"}}),t._v(" "),s("div",{staticClass:"btn-group"},[s("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.commentsPopover,callback:function(e){t.commentsPopover=e},expression:"commentsPopover"}},[s("emoji",{on:{select:t.selectEmoji}}),t._v(" "),s("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:a("woiz")},slot:"reference"})],1),t._v(" "),s("el-button",{staticClass:"rt",attrs:{type:"primary"},on:{click:t.commentsSub}},[t._v("发布")])],1)],1):s("div",{staticClass:"footer-bg",on:{click:function(e){t.addComments=!0}}},[t._v("添加评论")]),t._v(" "),t.replyList&&0!=t.replyList.length?s("div",{staticClass:"discuss"},t._l(t.replyList,function(e,i){return s("div",{key:i,staticClass:"discuss-list"},[s("div",{directives:[{name:"photo",rawName:"v-photo",value:e.user,expression:"discussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.user.img),expression:"$options.filters.filterUserLazyImg(discussItem.user.img)",arg:"background-image"}],key:e.user.img,staticClass:"div-photo head-img header-circle"}),t._v(" "),s("span",{staticClass:"name"},[t._v(t._s(e.user.realname))]),t._v(" "),s("span",{staticClass:"time"},[t._v(t._s(e.createTime))]),t._v(" "),s("div",{staticClass:"rt"},[s("span",{on:{click:function(a){t.discussDelete(e,t.replyList,i)}}},[t._v("删除")]),t._v(" "),s("span",{on:{click:function(a){t.discussBtn(e,-1)}}},[t._v("回复")])]),t._v(" "),s("p",{staticClass:"reply-title"},[s("span",{domProps:{innerHTML:t._s(t.emoji(e.content))}})]),t._v(" "),e.childCommentList&&e.childCommentList.length>0?s("div",{staticClass:"children-reply"},t._l(e.childCommentList,function(a,i){return s("div",{key:i,staticClass:"discuss-list"},[s("div",{directives:[{name:"photo",rawName:"v-photo",value:a.user,expression:"childDiscussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(a.user.img),expression:"$options.filters.filterUserLazyImg(childDiscussItem.user.img)",arg:"background-image"}],key:a.user.img,staticClass:"div-photo head-img header-circle"}),t._v(" "),s("span",{staticClass:"name"},[t._v(t._s(a.user.realname))]),t._v(" "),s("span",{staticClass:"time"},[t._v(t._s(a.createTime))]),t._v(" "),s("div",{staticClass:"rt"},[s("span",{on:{click:function(s){t.discussDelete(a,e.childCommentList,i)}}},[t._v("删除")]),t._v(" "),s("span",{on:{click:function(a){t.discussBtn(e,i)}}},[t._v("回复")])]),t._v(" "),s("p",{staticClass:"reply-title"},[[s("span",[t._v("回复")]),t._v(" "),a.replyUser?s("span",{staticClass:"reply"},[t._v("@"+t._s(a.replyUser.realname)+"：")]):t._e()],t._v(" "),s("span",{domProps:{innerHTML:t._s(t.emoji(a.content))}})],2)])})):t._e(),t._v(" "),e.show?s("div",{staticClass:"comment-box"},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},on:{blur:t.blurFun},model:{value:t.childCommentsTextarea,callback:function(e){t.childCommentsTextarea=e},expression:"childCommentsTextarea"}}),t._v(" "),s("div",{staticClass:"btn-group"},[s("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.childCommentsPopover,callback:function(e){t.childCommentsPopover=e},expression:"childCommentsPopover"}},[s("emoji",{on:{select:t.selectEmojiChild}}),t._v(" "),s("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:a("woiz")},slot:"reference"})],1),t._v(" "),s("div",{staticClass:"btn-box"},[s("el-button",{attrs:{type:"primary",loading:t.contentLoading},on:{click:function(e){t.childCommentSubmit()}}},[t._v("回复")]),t._v(" "),s("el-button",{on:{click:function(t){e.show=!1}}},[t._v("取消")])],1)],1)],1):t._e()])})):t._e()])]):s("div",{staticClass:"activity-box"},[0!=t.activityList.length?t._l(t.activityList,function(e,a){return s("div",{key:a,staticClass:"activity-list"},[s("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"item"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.img),expression:"$options.filters.filterUserLazyImg(item.img)",arg:"background-image"}],key:e.img,staticClass:"div-photo"}),t._v(" "),s("span",{staticClass:"activity-name"},[t._v(t._s(e.realname))]),t._v(" "),s("span",[t._v(t._s(e.content))]),t._v(" "),s("span",{staticClass:"activity-time"},[t._v(t._s(e.createTime))])])}):t._e()],2)])])]),t._v(" "),t._t("default")],2):t._e(),t._v(" "),t.taskData&&t.taskData.createUser?s("div",{staticClass:"tip"},[s("span",[t._v(t._s(t.taskData.createUser.realname)+" 创建于 "+t._s(t.taskData.createTime))])]):t._e(),t._v(" "),s("c-r-m-full-screen-detail",{attrs:{visible:t.showRelatedDetail,crmType:t.relatedCRMType,id:t.relatedID},on:{"update:visible":function(e){t.showRelatedDetail=e}}})],1)],1)},[],!1,null,"5ec93e3f",null));M.options.__file="particulars.vue";e.default=M.exports},"+NTD":function(t,e,a){"use strict";var s=a("/umX"),i=a.n(s),n=a("mX3o"),l=a("EgJF"),o=a("vG5h"),c=a("6zBA"),r=a("7Qib"),d={name:"relative-return-money",components:{CRMCreateView:l.default,CRMFullScreenDetail:function(){return Promise.all([a.e("chunk-0005"),a.e("chunk-276e"),a.e("chunk-162a"),a.e("chunk-2ce5")]).then(a.bind(null,"uMjE"))}},computed:{},mixins:[n.a],data:function(){return{list:[],fieldList:[],tableHeight:"250px",showFullDetail:!1,showFullCrmType:"receivables",showFullId:"",createCrmType:"receivables_plan",isCreate:!1,palnList:[],planFieldList:[],createActionInfo:{type:"relative",crmType:this.crmType,data:{}}}},watch:{id:function(t){this.list=[],this.palnList=[],this.getList(),this.getPlanList()}},props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},mounted:function(){this.planFieldList=[{prop:"num",width:"200",label:"期数"},{prop:"customerName",width:"200",label:"客户名称"},{prop:"contractNum",width:"200",label:"合同编号"},{prop:"money",width:"200",label:"计划回款金额"},{prop:"returnDate",width:"200",label:"计划回款日期"},{prop:"returnType",width:"200",label:"计划回款方式"},{prop:"remind",width:"200",label:"提前几日提醒"},{prop:"remark",width:"200",label:"备注"}],this.getPlanList(),this.fieldList=[{prop:"receivablesNum",width:"200",label:"回款编号"},{prop:"contractName",width:"200",label:"合同名称"},{prop:"contractMoney",width:"200",label:"合同金额"},{prop:"receivablesMoney",width:"200",label:"回款金额"},{prop:"ownerUserName",width:"200",label:"负责人"},{prop:"checkStatus",width:"200",label:"状态"},{prop:"returnTime",width:"200",label:"回款日期"}],this.getList()},activated:function(){},deactivated:function(){},methods:i()({getPlanList:function(){var t=this;this.loading=!0,(0,{customer:o.m,contract:c.d}[this.crmType])(this.getParams()).then(function(e){t.loading=!1,t.palnList=e.data}).catch(function(){t.loading=!1})},getList:function(){var t=this;this.loading=!0,(0,{customer:o.l,contract:c.c}[this.crmType])(this.getParams()).then(function(e){t.loading=!1,t.list=e.data}).catch(function(){t.loading=!1})},getParams:function(){return"customer"===this.crmType?{customerId:this.id,pageType:0}:"contract"===this.crmType?{contractId:this.id,pageType:0}:{}},handleRowClick:function(t,e,a){this.showFullId=t.receivablesId,this.showFullCrmType="receivables",this.showFullDetail=!0},planHandleRowClick:function(t,e,a){},cellStyle:function(t){t.row,t.column,t.rowIndex;return 1==t.columnIndex?{color:"#3E84E9"}:""},createClick:function(t){"money"==t?("contract"===this.crmType?(this.createActionInfo.data.customer=Object(r.i)(this.detail),this.createActionInfo.data.contract=Object(r.i)(this.detail)):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables",this.isCreate=!0):"plan"==t&&("contract"===this.crmType?(this.createActionInfo.data.customer=Object(r.i)(this.detail),this.createActionInfo.data.contract=Object(r.i)(this.detail)):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables_plan",this.isCreate=!0)},saveSuccess:function(){"receivables"==this.createCrmType?this.getList():this.getPlanList()},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}}},"cellStyle",function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}})},u=(a("ggbt"),a("ZrdR")),m=Object(u.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rc-cont"},[t.isSeas?t._e():a("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[a("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.createClick("plan")}}},[t._v("新建回款计划")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.palnList,height:t.tableHeight,stripe:"","header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle},on:{"row-click":t.planHandleRowClick}},t._l(t.planFieldList,function(t,e){return a("el-table-column",{key:e,attrs:{"show-overflow-tooltip":"",prop:t.prop,label:t.label}})})),t._v(" "),a("flexbox",{staticClass:"rc-head",staticStyle:{"margin-top":"15px"},attrs:{direction:"row-reverse"}},[t.isSeas?t._e():a("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.createClick("money")}}},[t._v("新建回款")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,stripe:"","header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle},on:{"row-click":t.handleRowClick}},t._l(t.fieldList,function(t,e){return a("el-table-column",{key:e,attrs:{"show-overflow-tooltip":"",prop:t.prop,label:t.label}})})),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,crmType:t.showFullCrmType,id:t.showFullId},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.isCreate?a("c-r-m-create-view",{attrs:{"crm-type":t.createCrmType,action:t.createActionInfo},on:{"save-success":t.saveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"21df662a",null);m.options.__file="RelativeReturnMoney.vue";e.a=m.exports},"/Wwe":function(t,e,a){},"/umX":function(t,e,a){"use strict";e.__esModule=!0;var s=function(t){return t&&t.__esModule?t:{default:t}}(a("9dlP"));e.default=function(t,e,a){return e in t?(0,s.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},"1RnH":function(t,e,a){"use strict";var s=a("+9th"),i=a("mkuN"),n=a("Er7M"),l=a("7Qib"),o={components:{CrmRelative:i.a,RelatedBusinessCell:n.a},data:function(){return{showTypes:["customer","contacts","business","contract"],showPopover:!1,relevanceAll:{customerIds:[],contractIds:[],contactsIds:[],businessIds:[]},relatedListData:{},showRelative:!1,showTaskRelative:!1}},watch:{allData:function(){this.relatedListData=this.allData}},props:{marginLeft:{type:String,default:"20px"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},isTask:{type:Boolean,default:!1},taskID:Number,alterable:{type:Boolean,default:!0},alterableColor:{type:String,default:"#999"}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(t){var e=this;this.showPopover=!1,this.relatedListData=t.data;var a=function(a){var s=t.data[a];e.relevanceAll[a+"Ids"]=s.map(function(t,e,s){return t[a+"Id"]})};for(var s in t.data)a(s);this.$emit("checkInfos",this.relevanceAll)},delRelevance:function(t,e,a){var i=this;this.$confirm("确认取消关联?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){for(var a={taskId:i.taskID},n=function(t){var e=i.showTypes[t],s=i.relatedListData[e]||[];a[e+"Ids"]=s.map(function(t){return t[e+"Id"]}).join(",")},o=0;o<i.showTypes.length;o++)n(o);Object(s.h)(a).then(function(a){i.relatedListData[t].splice(e,1),i.relatedListData=Object(l.i)(i.relatedListData),i.$message.success("关联取消成功")}).catch(function(){})}).catch(function(){i.$message.info("已取消操作")})},checkRelatedDetail:function(t,e){e.key=e[t+"Id"],this.$emit("checkRelatedDetail",t,e)}}},c=(a("pXDA"),a("ZrdR")),r=Object(c.a)(o,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"related-business",style:{"margin-left":t.marginLeft}},[!t.isTask&&t.alterable?s("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showRelative?s("crm-relative",{ref:"crmrelative",attrs:{show:t.showPopover,radio:!1,selectedData:t.relatedListData,showTypes:t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),s("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showRelative=!0}},slot:"reference"},[s("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n      关联业务\n    ")])],1):t._e(),t._v(" "),t.alterable?t._e():s("p",{staticClass:"alterable-p",style:{color:t.alterableColor}},[t._v("关联业务")]),t._v(" "),t._l(t.relatedListData,function(e,a){return s("div",{key:a},t._l(e,function(e,i){return s("related-business-cell",{key:i,attrs:{data:e,cellIndex:i,type:a,showFoot:t.isTask},on:{unbind:t.delRelevance,detail:function(s){t.checkRelatedDetail(a,e)}}})}))}),t._v(" "),t.isTask?s("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showTaskRelative?s("crm-relative",{ref:"crmrelative",attrs:{radio:!1,show:t.showPopover,selectedData:t.relatedListData,showTypes:t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),s("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showTaskRelative=!0}},slot:"reference"},[s("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n      关联业务\n    ")])],1):t._e()],2)},[],!1,null,"58b3dba6",null);r.options.__file="relatedBusiness.vue";e.a=r.exports},"37nJ":function(t,e,a){"use strict";var s=a("pKcZ");a.n(s).a},"3JdR":function(t,e,a){"use strict";var s=a("e22y");a.n(s).a},"4G+T":function(t,e,a){"use strict";var s=a("lRLZ");a.n(s).a},"5DLP":function(t,e,a){a("JnXs");var s=a("g24s").Object;t.exports=function(t,e,a){return s.defineProperty(t,e,a)}},"6K8m":function(t,e,a){"use strict";var s=a("VKxC");a.n(s).a},"7ccD":function(t,e,a){},"7z+D":function(t,e,a){"use strict";var s=a("ExMk"),i=a("Ew9n"),n=a("EP+0"),l=a("3biH"),o=a("Er7M"),c=a("O1Uw"),r=a("7Qib"),d=(a("a/LZ"),{name:"examine-detail",components:{SlideView:i.a,CreateSections:n.a,ExamineInfo:l.a,RelatedBusinessCell:o.a,CRMFullScreenDetail:function(){return a.e("chunk-a8c9").then(a.bind(null,"uMjE"))},FileCell:c.a},props:{id:[String,Number],noListenerClass:{type:Array,default:function(){return["list-box"]}}},watch:{id:function(t){this.getDetial()}},data:function(){return{loading:!1,categoryId:"",detail:{examineRecordId:""},list:[],categoryName:"",fileList:[],imgList:[],travelList:[],travelField:[{prop:"vehicle",label:"交通工具"},{prop:"trip",label:"单程往返"},{prop:"startAddress",label:"出发城市"},{prop:"endAddress",label:"目的城市"},{prop:"startTime",label:"开始时间"},{prop:"endTime",label:"结束时间"},{prop:"duration",label:"时长（天）"},{prop:"description",label:"备注"}],expensesField:[{prop:"startAddress",label:"出发城市"},{prop:"endAddress",label:"目的城市"},{prop:"startTime",label:"开始时间"},{prop:"endTime",label:"结束时间"},{prop:"traffic",label:"交通费（元）"},{prop:"stay",label:"住宿费（元）"},{prop:"diet",label:"餐饮费（元）"},{prop:"other",label:"其他费用（元）"},{prop:"description",label:"费用明细描述"}],relatedID:"",relatedCRMType:"",showRelatedDetail:!1}},computed:{relatedListData:function(){return{contacts:this.detail.contactsList||[],customer:this.detail.customerList||[],business:this.detail.businessList||[],contract:this.detail.contractList||[]}}},mounted:function(){this.getDetial()},methods:{getBaseInfo:function(){var t=this;this.loading=!0,Object(s.a)({examineId:this.id}).then(function(e){t.list=e.data,t.loading=!1}).catch(function(){t.loading=!1})},getDetial:function(){var t=this;this.loading=!0,Object(s.j)({examineId:this.id}).then(function(e){t.loading=!1,t.categoryId=e.data.categoryId,t.getBaseInfo(),t.detail=e.data,t.categoryName=t.detail.category,t.fileList=t.detail.file,t.imgList=t.detail.img,t.travelList=t.detail.examineTravelList}).catch(function(){t.loading=!1})},hideView:function(){this.$emit("hide-view")},checkRelatedDetail:function(t,e){this.relatedID=e[t+"Id"],this.relatedCRMType=t,this.showRelatedDetail=!0},handleFile:function(t,e,a){if("preview"===t){if(e&&e.length>0){var s=e.map(function(t){return t.url=t.filePath,t});this.$bus.emit("preview-image-bus",{index:a,data:s})}}else"download"===t&&Object(r.a)({path:e.filePath,name:e.name})},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,a){return{url:t.filePath,name:t.name}})})},downloadFile:function(t){Object(r.a)({path:t.filePath,name:t.name})},examineHandle:function(t){this.$emit("on-examine-handle",t)}}}),u=(a("NxN7"),a("ZrdR")),m=Object(u.a)(d,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("slide-view",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-view",attrs:{listenerIDs:["workbench-main-container"],noListenerClass:t.noListenerClass,"body-style":{padding:"10px 30px",height:"100%"}},on:{"side-close":t.hideView}},[s("flexbox",{staticStyle:{height:"100%"},attrs:{orient:"vertical"}},[s("flexbox",{staticClass:"detail-header"},[s("div",{staticClass:"header-name"},[t._v(t._s(t.categoryName))]),t._v(" "),s("img",{staticClass:"header-close",attrs:{src:a("cjwK")},on:{click:t.hideView}})]),t._v(" "),s("div",{staticClass:"detail-body"},[s("flexbox",{attrs:{gutter:0,align:"stretch",wrap:"wrap"}},t._l(t.list,function(e,i){return"examine_cause"!==e.formType&&"business_cause"!==e.formType?s("flexbox-item",{key:i,staticClass:"b-cell",attrs:{span:.5}},["user"===e.formType?s("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[s("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"b-cell-value"},[s("flexbox",{staticStyle:{padding:"0px 10px 10px 0px"},attrs:{gutter:0,wrap:"wrap"}},t._l(e.value,function(e,a){return s("div",{key:a},[t._v("\n                  "+t._s(e.realname)+"  \n                ")])}))],1)]):"structure"===e.formType?s("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[s("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"b-cell-value"},[s("flexbox",{staticStyle:{padding:"0px 10px 10px 0px"},attrs:{gutter:0,wrap:"wrap"}},t._l(e.value,function(e,a){return s("div",{key:a},[t._v("\n                  "+t._s(e.name)+"  \n                ")])}))],1)]):"checkbox"===e.formType?s("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[s("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"b-cell-value"},[s("flexbox",{staticStyle:{padding:"0px 10px 10px 0px"},attrs:{gutter:0,wrap:"wrap"}},t._l(e.value,function(e,a){return s("div",{key:a},[t._v("\n                  "+t._s(e)+"  \n                ")])}))],1)]):"file"===e.formType?s("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[s("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"b-cell-value"},t._l(e.value,function(i,n){return s("flexbox",{key:n,staticClass:"f-item"},[s("img",{staticClass:"f-img",attrs:{src:a("6KEE")}}),t._v(" "),s("div",{staticClass:"f-name"},[t._v(t._s(i.name.length>15?i.name.substring(0,15)+"...":i.name+"("+i.size+")"))]),t._v(" "),s("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){t.handleFile("preview",e.value,n)}}},[t._v("预览")]),t._v(" "),s("el-button",{attrs:{type:"text"},nativeOn:{click:function(e){t.handleFile("download",i,n)}}},[t._v("下载")])],1)}))]):s("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[s("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"b-cell-value"},[t._v(t._s(e.value))])])],1):t._e()})),t._v(" "),t.fileList.length>0||t.imgList.length>0?s("div",{staticClass:"accessory"},[s("div",{staticClass:"upload-img-box"},t._l(t.imgList,function(e,a){return s("div",{key:a,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.imgList,a)}}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.filePath,expression:"imgItem.filePath"}],key:e.filePath})])})),t._v(" "),s("div",{staticClass:"accessory-box"},t._l(t.fileList,function(t,e){return s("file-cell",{key:e,attrs:{data:t,cellIndex:e}})}))]):t._e(),t._v(" "),t.categoryId&&3==t.categoryId&&t.travelList&&t.travelList.length>0?s("create-sections",{staticClass:"create-sections",attrs:{title:"行程"}},[s("el-table",{staticStyle:{"font-size":"13px"},attrs:{data:t.travelList,align:"center","header-align":"center",stripe:""}},t._l(t.travelField,function(e,a){return s("el-table-column",{key:a,attrs:{"show-overflow-tooltip":"",prop:e.prop,label:e.label},scopedSlots:t._u([{key:"header",fn:function(e){return[s("div",{staticClass:"table-head-name"},[t._v(t._s(e.column.label))])]}}])})}))],1):t._e(),t._v(" "),t.categoryId&&5==t.categoryId&&t.travelList&&t.travelList.length>0?s("create-sections",{staticClass:"create-sections",attrs:{title:"报销"}},[s("el-table",{staticStyle:{"font-size":"13px"},attrs:{data:t.travelList,align:"center","header-align":"center",stripe:""}},[t._l(t.expensesField,function(e,a){return s("el-table-column",{key:a,attrs:{"show-overflow-tooltip":"",prop:e.prop,label:e.label},scopedSlots:t._u([{key:"header",fn:function(e){return[s("div",{staticClass:"table-head-name"},[t._v(t._s(e.column.label))])]}}])})}),t._v(" "),s("el-table-column",{attrs:{label:"发票",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("flexbox",{attrs:{justify:"center"}},[s("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){t.handleFile("preview",e.row.img,0)}}},[t._v(t._s(e.row.img.length)+"张")])],1)]}}])})],2)],1):t._e(),t._v(" "),t.relatedListData.contacts.length>0||t.relatedListData.customer.length>0||t.relatedListData.business.length>0||t.relatedListData.contract.length>0?s("create-sections",{staticClass:"create-sections",attrs:{title:"关联业务"}},[s("div",{staticClass:"related-business create-sections-content"},t._l(t.relatedListData,function(e,a){return s("div",{key:a},t._l(e,function(e,i){return s("related-business-cell",{key:i,attrs:{data:e,cellIndex:i,type:a,showFoot:!1},nativeOn:{click:function(s){t.checkRelatedDetail(a,e)}}})}))}))]):t._e(),t._v(" "),s("create-sections",{staticClass:"create-sections",attrs:{title:"审核信息"}},[s("examine-info",{staticClass:"create-sections-content",attrs:{id:t.id,examineType:"oa_examine",recordId:t.detail.examineRecordId},on:{"on-handle":t.examineHandle}})],1)],1)],1),t._v(" "),s("c-r-m-full-screen-detail",{attrs:{visible:t.showRelatedDetail,crmType:t.relatedCRMType,id:t.relatedID},on:{"update:visible":function(e){t.showRelatedDetail=e}}})],1)},[],!1,null,"7c87fbb5",null);m.options.__file="examineDetail.vue";e.a=m.exports},"84/7":function(t,e,a){},"8KPp":function(t,e,a){"use strict";var s=a("rerW"),i=a.n(s),n=a("Qldq"),l=a("Iae0"),o=a("KzkL"),c=(a("7Qib"),{name:"journal-log",components:{JournalCell:l.a,CRMFullScreenDetail:function(){return Promise.all([a.e("chunk-0005"),a.e("chunk-276e"),a.e("chunk-162a"),a.e("chunk-2ce5")]).then(a.bind(null,"uMjE"))},NewDialog:function(){return a.e("chunk-7beb").then(a.bind(null,"kFvY"))}},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(t){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showFullDetail:!1,detailCRMType:"",showNewDialog:!1,formData:{},dialogTitle:"",imgFileList:[],accessoryFileList:[],newLoading:!1}},computed:{},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){e.scrollTop+e.clientHeight==e.scrollHeight&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0;var e={page:this.page,limit:10};e[this.crmType+"Ids"]=this.id,Object(o.l)(e).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},jourecallCellHandle:function(t){var e=this;if("edit"==t.type){var a=t.data.item;if(this.showNewDialog=!0,this.dialogTitle="编辑日志",this.formData=a,this.imgFileList=[],a.imgList){var s=!0,l=!1,o=void 0;try{for(var c,r=i()(a.imgList);!(s=(c=r.next()).done);s=!0){var d=c.value;d.url=d.filePath,this.imgFileList.push(d)}}catch(t){l=!0,o=t}finally{try{!s&&r.return&&r.return()}finally{if(l)throw o}}}if(this.accessoryFileList=[],a.fileList){var u=!0,m=!1,h=void 0;try{for(var p,v=i()(a.fileList);!(u=(p=v.next()).done);u=!0){var f=p.value;f.url=f.filePath,this.accessoryFileList.push(f)}}catch(t){m=!0,h=t}finally{try{!u&&v.return&&v.return()}finally{if(m)throw h}}}this.formData.depData=a.sendStructList?a.sendStructList:[],this.formData.sentWhoList=a.sendUserList?a.sendUserList:[]}else"delete"==t.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.b)({logId:t.data.item.logId}).then(function(a){for(var s in e.$message({type:"success",message:"删除成功!"}),e.list)if(e.list[s].logId==t.data.item.logId){e.list.splice(s,1);break}})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):"related-detail"==t.type&&(this.rowID=t.data.item.key,this.detailCRMType=t.data.type,this.showFullDetail=!0)},submitBtn:function(t,e,a,s){var l=this;this.newLoading=!0;var o=[],c=[],r=[];if(this.formData.depData){var d=!0,u=!1,m=void 0;try{for(var h,p=i()(this.formData.depData);!(d=(h=p.next()).done);d=!0){var v=h.value;r.push(v.id)}}catch(t){u=!0,m=t}finally{try{!d&&p.return&&p.return()}finally{if(u)throw m}}}var f=[];if(this.formData.sentWhoList){var g=!0,b=!1,k=void 0;try{for(var y,C=i()(this.formData.sentWhoList);!(g=(y=C.next()).done);g=!0){var _=y.value;f.push(_.id)}}catch(t){b=!0,k=t}finally{try{!g&&C.return&&C.return()}finally{if(b)throw k}}}var w=!0,x=!1,I=void 0;try{for(var D,T=i()(this.imgFileList);!(w=(D=T.next()).done);w=!0){var L=D.value;o.push(L.fileId)}}catch(t){x=!0,I=t}finally{try{!w&&T.return&&T.return()}finally{if(x)throw I}}var A=!0,R=!1,j=void 0;try{for(var E,M=i()(this.accessoryFileList);!(A=(E=M.next()).done);A=!0){var N=E.value;c.push(N.fileId)}}catch(t){R=!0,j=t}finally{try{!A&&M.return&&M.return()}finally{if(R)throw j}}var S={id:this.formData.logId,categoryId:t,content:this.formData.content,tomorrow:this.formData.tomorrow,question:this.formData.question,file:c.concat(o),sendUserIds:f,sendStructureIds:r,customerIds:s.customerIds,contactsIds:s.contactsIds,businessIds:s.businessIds,contractIds:s.contractIds};Object(n.c)(S).then(function(t){l.refreshList(),l.showNewDialog=!1,l.$message.success("编辑成功"),l.newLoading=!1}).catch(function(t){l.newLoading=!1,l.$message.error("编辑失败")})}}}),r=(a("4G+T"),a("ZrdR")),d=Object(r.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[a("div",{staticClass:"log-items"},[t._l(t.list,function(e,s){return a("journal-cell",{key:s,staticClass:"list-cell",attrs:{data:e},on:{"on-handle":t.jourecallCellHandle}})}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,crmType:t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.showNewDialog?a("new-dialog",{attrs:{formData:t.formData,dialogTitle:t.dialogTitle,imgFileList:t.imgFileList,accessoryFileList:t.accessoryFileList,newLoading:t.newLoading},on:{close:function(e){t.showNewDialog=!1},submitBtn:t.submitBtn}}):t._e()],1)},[],!1,null,"17d17ba2",null);d.options.__file="JournalLog.vue";e.a=d.exports},"9dlP":function(t,e,a){t.exports={default:a("5DLP"),__esModule:!0}},Bc4i:function(t,e,a){"use strict";var s=a("oCac");a.n(s).a},BuGm:function(t,e,a){"use strict";a.r(e);var s=a("omC7"),i=a.n(s),n=a("rerW"),l=a.n(n),o=a("Dh/N"),c=(a("KTTK"),a("1RnH")),r=a("0hym"),d=a("7Qib"),u={components:{relatedBusiness:c.a,XhUser:r.a},data:function(){return{zIndex:Object(d.g)(),formList:[{label:"主题",field:"title",type:"color"},{label:"开始时间",field:"startTime",type:"time"},{label:"结束时间",field:"endTime",type:"time"},{label:"参与人",field:"ownerUserIds",type:"participant"},{label:"备注",field:"remark",type:"textarea",width:"100%"}],options:[{value:0,label:"无"},{value:1,label:"准时提醒"},{value:2,label:"5分钟前"},{value:3,label:"15分钟前"},{value:4,label:"30分钟前"},{value:5,label:"一个小时前"},{value:6,label:"二个小时前"},{value:7,label:"一天前"},{value:8,label:"二天前"},{value:9,label:"一周前"}],fileList:[],loading:!1,colorList:["#3E8EF7","#11C06C","#0BB2D4","#EB6709","#FF4C52","#526069","#9262F4"],rules:{title:[{required:!0,message:"主题不能为空",trigger:"blur"},{max:50,message:"主题长度最多为50个字符",trigger:"blur"}],startTime:[{required:!0,message:"开始时间不能为空",trigger:"blur"}],endTime:[{required:!0,message:"结束时间不能为空",trigger:"blur"}]},relevanceAll:{},allData:{},colleaguesList:[]}},props:{formData:{type:Object,default:function(){return{color:""}}},text:{type:String,default:"创建日程"},appendToBody:{type:Boolean,default:!1}},created:function(){},mounted:function(){this.appendToBody&&document.body.appendChild(this.$el),this.allData.business=this.formData.businessList?this.formData.businessList:[],this.allData.contacts=this.formData.contactsList?this.formData.contactsList:[],this.allData.contract=this.formData.contractList?this.formData.contractList:[],this.allData.customer=this.formData.customerList?this.formData.customerList:[],this.formData.ownerList&&(this.colleaguesList=[].concat(this.formData.ownerList)),"创建日程"==this.text&&this.$set(this.formData,"color","#3E8EF7")},methods:{close:function(){1==this.$route.query.routerKey?this.$router.go(-1):this.$emit("closeDialog")},checkInfos:function(t){this.relevanceAll=t},onSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0;var a=t.formData,s=[],n=!0,c=!1,r=void 0;try{for(var d,u=l()(t.colleaguesList);!(n=(d=u.next()).done);n=!0){var m=d.value;s.push(m.userId)}}catch(t){c=!0,r=t}finally{try{!n&&u.return&&u.return()}finally{if(c)throw r}}if("创建日程"==t.text)Object(o.a)({title:a.title,startTime:a.startTime,endTime:a.endTime,ownerUserIds:s.join(","),remark:a.remark,color:a.color,customerIds:t.relevanceAll.customerIds?t.relevanceAll.customerIds.join(","):[],contactsIds:t.relevanceAll.contactsIds?t.relevanceAll.contactsIds.join(","):[],businessIds:t.relevanceAll.businessIds?t.relevanceAll.businessIds.join(","):[],contractIds:t.relevanceAll.contractIds?t.relevanceAll.contractIds.join(","):[]}).then(function(e){1==t.$route.query.routerKey?t.$router.push("schedule"):t.$emit("onSubmit"),t.loading=!1}).catch(function(e){t.loading=!1});else{var h={customerIds:[],contractIds:[],contactsIds:[],businessIds:[]};if(t.allData.customer){var p=!0,v=!1,f=void 0;try{for(var g,b=l()(t.allData.customer);!(p=(g=b.next()).done);p=!0){var k=g.value;h.customerIds.push(k.customerId)}}catch(t){v=!0,f=t}finally{try{!p&&b.return&&b.return()}finally{if(v)throw f}}}if(t.allData.contract){var y=!0,C=!1,_=void 0;try{for(var w,x=l()(t.allData.contract);!(y=(w=x.next()).done);y=!0){var I=w.value;h.contractIds.push(I.contractId)}}catch(t){C=!0,_=t}finally{try{!y&&x.return&&x.return()}finally{if(C)throw _}}}if(t.allData.contacts){var D=!0,T=!1,L=void 0;try{for(var A,R=l()(t.allData.contacts);!(D=(A=R.next()).done);D=!0){var j=A.value;h.contactsIds.push(j.contactsId)}}catch(t){T=!0,L=t}finally{try{!D&&R.return&&R.return()}finally{if(T)throw L}}}if(t.allData.business){var E=!0,M=!1,N=void 0;try{for(var S,O=l()(t.allData.business);!(E=(S=O.next()).done);E=!0){var U=S.value;h.businessIds.push(U.businessId)}}catch(t){M=!0,N=t}finally{try{!E&&O.return&&O.return()}finally{if(M)throw N}}}var B="{}"==i()(t.relevanceAll)?h:t.relevanceAll;Object(o.c)({eventId:a.eventId,title:a.title,startTime:a.startTime,endTime:a.endTime,ownerUserIds:s.join(","),remark:a.remark,color:a.color,customerIds:B.customerIds.join(","),contactsIds:B.contactsIds.join(","),businessIds:B.businessIds.join(","),contractIds:B.contractIds.join(",")}).then(function(e){t.$emit("onSubmit"),t.loading=!1}).catch(function(e){t.loading=!1})}})},httpRequest:function(t){this.fileList.push(t.file)},onRemove:function(t){for(var e in this.fileList)this.fileList[e].uid==t.uid&&this.fileList.splice(e,1)},changeColor:function(t){this.$set(this.formData,"color",t)},changeCheckout:function(t){this.colleaguesList=t.data},selectDelect:function(t,e){this.$refs.xhuser[0].cancelCheckItem(t),this.colleaguesList.splice(e,1)}},beforeDestroy:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},m=(a("HIJc"),a("ZrdR")),h=Object(m.a)(u,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"create-schedule",style:{"z-index":t.zIndex}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"add-schedule"},[s("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"text"},[t._v(t._s(t.text))]),t._v(" "),s("img",{staticClass:"el-icon-close rt",attrs:{src:a("cjwK"),alt:""},on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"content"},[s("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules}},t._l(t.formList,function(e,a){return s("el-form-item",{key:a,class:"el-form-item-"+e.field,style:{width:e.width},attrs:{prop:e.field,label:e.label}},["time"==e.type?[s("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})]:"textarea"==e.type?[s("el-input",{attrs:{type:"textarea",autosize:{minRows:6},placeholder:"请输入内容"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})]:"participant"==e.type?[s("el-popover",{attrs:{placement:"bottom-end",width:"280",trigger:"click"}},[s("xh-user",{ref:"xhuser",refInFor:!0,attrs:{selectedData:t.colleaguesList},on:{changeCheckout:t.changeCheckout}}),t._v(" "),s("div",{staticClass:"select-box",attrs:{slot:"reference"},slot:"reference"},[t._l(t.colleaguesList,function(e,a){return s("span",{key:a,staticClass:"select-box-span"},[t._v("\n                  "+t._s(e.realname)+"\n                  "),s("span",{staticClass:"el-icon-close",on:{click:function(s){s.stopPropagation(),t.selectDelect(e,a)}}})])}),t._v(" "),s("span",{staticClass:"el-icon-plus"})],2)],1)]:"select"==e.type?[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}},t._l(t.options,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))]:"color"==e.type?[s("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}},[s("i",{staticClass:"el-input__icon",attrs:{slot:"prefix"},slot:"prefix"},[s("span",{staticClass:"bg-color",style:{background:t.formData.color}})])]),t._v(" "),s("div",{staticClass:"color-box"},t._l(t.colorList,function(e,a){return s("span",{key:a,style:{background:e},on:{click:function(a){t.changeColor(e)}}})}))]:s("el-input",{model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})],2)})),t._v(" "),s("related-business",{attrs:{allData:t.allData},on:{checkInfos:t.checkInfos}})],1),t._v(" "),s("div",{staticClass:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")]),t._v(" "),s("el-button",{on:{click:t.close}},[t._v("取消")])],1)])])},[],!1,null,"36cfc72d",null);h.options.__file="createSchedule.vue";e.default=h.exports},CT8I:function(t,e,a){},DBls:function(t,e,a){},DLJz:function(t,e,a){},DUlf:function(t,e,a){"use strict";var s=a("mX3o"),i=a("eOzp"),n=a("vG5h"),l=a("UcQx"),o=a("6zBA"),c={name:"relative-team",components:{TeamsHandle:i.a},computed:{},mixins:[s.a],data:function(){return{list:[],fieldList:[],tableHeight:"400px",teamsDialogShow:!1,handleType:1,editPermissionShow:!1,selectionList:[]}},watch:{id:function(t){this.list=[],this.getDetail()}},props:{id:[String,Number],detail:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},mounted:function(){this.fieldList.push({prop:"realname",width:"200",label:"姓名"}),this.fieldList.push({prop:"name",width:"200",label:"职位"}),this.fieldList.push({prop:"groupRole",width:"200",label:"团队角色"}),this.fieldList.push({prop:"power",width:"200",label:"权限"}),this.getDetail()},activated:function(){},deactivated:function(){},methods:{getDetail:function(){var t=this;this.loading=!0;var e={customer:n.t,business:l.m,contract:o.k}[this.crmType],a={};a[this.crmType+"Id"]=this.id,e(a).then(function(e){t.loading=!1,t.list=e.data}).catch(function(){t.loading=!1})},handleSelectionChange:function(t){this.selectionList=t},handleClick:function(t){var e=this;"add"==t?this.teamsDialogShow=!0:0==this.selectionList.length?this.$message.error("请勾选需要操作的团队成员"):"edit"==t?this.editPermissionShow=!0:"remove"==t&&this.$confirm("此操作将移除这些团队成员是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.selectionList.map(function(t,e,a){return t.id}),a={customer:n.r,contract:o.i,business:l.i}[e.crmType],s={ids:e.id,memberIds:t.join(",")};e.loading=!0,a(s).then(function(t){e.$message({type:"success",message:"操作成功"}),e.loading=!1,e.getDetail()}).catch(function(){e.loading=!1})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleCallBack:function(t){this.getDetail()},handleEditConfirm:function(){var t=this,e=this.selectionList.map(function(t,e,a){return t.id});this.loading=!0,(0,{customer:n.v,business:l.o,contract:o.m}[this.crmType])({ids:this.id,memberIds:e.join(","),power:this.handleType}).then(function(e){t.editPermissionShow=!1,t.$message({type:"success",message:"操作成功"}),t.loading=!1,t.getDetail()}).catch(function(){t.loading=!1})},handleSelectable:function(t,e){return"负责人权限"!=t.power},handleRowClick:function(t,e,a){},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}}}},r=(a("v84z"),a("ZrdR")),d=Object(r.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rc-cont"},[t.isSeas?t._e():a("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[a("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("remove")}}},[t._v("移除")]),t._v(" "),a("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("edit")}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("add")}}},[t._v("添加团队成员")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,stripe:"","header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle},on:{"row-click":t.handleRowClick,"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55",selectable:t.handleSelectable}}),t._v(" "),t._l(t.fieldList,function(t,e){return a("el-table-column",{key:e,attrs:{"show-overflow-tooltip":"",prop:t.prop,label:t.label}})})],2),t._v(" "),a("teams-handle",{attrs:{crmType:t.crmType,title:"添加团队成员",selectionList:[t.detail],dialogVisible:t.teamsDialogShow},on:{handle:t.handleCallBack,"update:dialogVisible":function(e){t.teamsDialogShow=e}}}),t._v(" "),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{title:"编辑权限",visible:t.editPermissionShow,"append-to-body":!0,width:"400px"},on:{"update:visible":function(e){t.editPermissionShow=e}}},[a("div",{staticClass:"handle-box"},[a("flexbox",{staticClass:"handle-item"},[a("div",{staticClass:"handle-item-name"},[t._v("权限：")]),t._v(" "),a("el-radio-group",{model:{value:t.handleType,callback:function(e){t.handleType=e},expression:"handleType"}},[a("el-radio",{attrs:{label:1}},[t._v("只读")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("读写")])],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.editPermissionShow=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.handleEditConfirm(e)}}},[t._v("保存")])],1)])],1)},[],!1,null,"53249d40",null);d.options.__file="RelativeTeam.vue";e.a=d.exports},DcnZ:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhDRDcyQTY3RTE2RTExRThCRTI2OUUxNDM4MTM1RjMzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhDRDcyQTY4RTE2RTExRThCRTI2OUUxNDM4MTM1RjMzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OENENzJBNjVFMTZFMTFFOEJFMjY5RTE0MzgxMzVGMzMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OENENzJBNjZFMTZFMTFFOEJFMjY5RTE0MzgxMzVGMzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6YLrWcAAAAYklEQVR42mL8//8/AzUBEwOVwaiBg9BAlrNnz9LEhZ5A/AyKPdHUkCTHeObMGQaogCRU0XMglkLSRJIctjBkxOMjgnIwA1OA+AUQPwXiZDSFJMnBvEw1wDhaOIwaSDoACDAAtBYiKbAuMEoAAAAASUVORK5CYII="},"Dh/N":function(t,e,a){"use strict";a.d(e,"d",function(){return i}),a.d(e,"a",function(){return n}),a.d(e,"b",function(){return l}),a.d(e,"c",function(){return o});var s=a("t3Un");function i(t){return Object(s.a)({url:"OaEvent/queryList",method:"post",data:t})}function n(t){return Object(s.a)({url:"OaEvent/add",method:"post",data:t})}function l(t){return Object(s.a)({url:"OaEvent/delete",method:"post",data:t})}function o(t){return Object(s.a)({url:"OaEvent/update",method:"post",data:t})}},DhPt:function(t,e,a){"use strict";var s=a("84/7");a.n(s).a},E8ba:function(t,e,a){},Fpl1:function(t,e,a){"use strict";var s=a("Er7M"),i=a("O1Uw"),n={name:"examine-cell",components:{RelatedBusinessCell:s.a,FileCell:i.a},mixins:[],computed:{relatedListData:function(){return{contacts:this.data.contactsList||[],customer:this.data.customerList||[],business:this.data.businessList||[],contract:this.data.contractList||[]}}},watch:{},data:function(){return{}},props:{data:Object},mounted:function(){},methods:{getStatusName:function(t){return 0==t?"待审":1==t?"审核通过":2==t?"审核拒绝":3==t?"审核中":4==t?"撤回":""},getStatusColor:function(t){return 0==t?"#F3A633":1==t?"#93E06D":2==t?"#FF0000":3==t?"#F3A633":4==t?"#FF0000":""},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,a){return{url:t.filePath,name:t.name}})})},downloadFile:function(t){},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})},checkDetail:function(t){this.$emit("on-handle",{type:"view",data:{item:this.data}})},checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})}}},l=(a("faIZ"),a("ZrdR")),o=Object(l.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("div",{staticClass:"list-content"},[a("flexbox",{staticClass:"header"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],staticClass:"div-photo head-img"}),t._v(" "),a("div",{staticClass:"name-time"},[a("span",{staticClass:"name"},[t._v(t._s(t.data.createUser.realname))]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(t.data.createtime))])]),t._v(" "),a("div",{staticClass:"rt-setting"},[a("span",{staticClass:"bg-color",style:{"background-color":t.getStatusColor(t.data.examineStatus)}}),t._v(" "),a("span",{staticClass:"dep"},[a("span",[t._v(t._s(t.data.categoryTitle)+" - ")]),t._v(" "),a("span",[t._v(t._s(t.getStatusName(t.data.examineStatus)))])]),t._v(" "),t.data.permission&&(t.data.permission.isChecked||t.data.permission.isUpdate||t.data.permission.isDelete)?a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.data.permission&&t.data.permission.isChecked?a("el-dropdown-item",{attrs:{command:"withdraw"}},[t._v("撤回")]):t._e(),t._v(" "),t.data.permission&&t.data.permission.isUpdate?a("el-dropdown-item",{attrs:{command:"edit"}},[t._v("编辑")]):t._e(),t._v(" "),t.data.permission&&t.data.permission.isDelete?a("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")]):t._e()],1)],1):t._e()],1)]),t._v(" "),a("div",{staticClass:"row",on:{click:function(e){t.checkDetail(t.data)}}},[t.data.content?a("p",{staticClass:"text"},[t._v(t._s(t.data.content))]):t._e(),t._v(" "),t.data.causeTitle?a("p",{staticClass:"title"},[t._v(t._s(t.data.causeTitle))]):t._e()]),t._v(" "),t.data.file.length>0||t.data.img.length>0?a("div",{staticClass:"accessory"},[a("div",{staticClass:"upload-img-box"},t._l(t.data.img,function(e,s){return a("div",{key:s,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.data.img,s)}}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.filePath,expression:"imgItem.filePath"}]})])})),t._v(" "),a("div",{staticClass:"accessory-box"},t._l(t.data.file,function(t,e){return a("file-cell",{key:e,attrs:{data:t,cellIndex:e}})}))]):t._e(),t._v(" "),t.relatedListData.contacts.length>0||t.relatedListData.customer.length>0||t.relatedListData.business.length>0||t.relatedListData.contract.length>0?a("div",{staticClass:"related-business"},[a("div",{staticClass:"label"},[t._v("关联业务")]),t._v(" "),t._l(t.relatedListData,function(e,s){return a("div",{key:s},t._l(e,function(e,i){return a("related-business-cell",{key:i,attrs:{data:e,cellIndex:i,type:s,showFoot:!1},nativeOn:{click:function(a){t.checkRelatedDetail(s,e)}}})}))})],2):t._e()],1)])},[],!1,null,"2c9f608a",null);o.options.__file="examineCell.vue";e.a=o.exports},GIzo:function(t,e,a){"use strict";var s=a("n1CD");a.n(s).a},HIJc:function(t,e,a){"use strict";var s=a("i1an");a.n(s).a},I6we:function(t,e,a){"use strict";var s=a("/Wwe");a.n(s).a},Iae0:function(t,e,a){"use strict";var s=a("bS4n"),i=a.n(s),n=a("S3Kq"),l=a("Qldq"),o=a("vPra"),c=a("1RnH"),r=a("8t5x"),d=a("O1Uw"),u={name:"journal-cell",components:{emoji:n.a,relatedBusiness:c.a,FileCell:d.a},mixins:[],computed:i()({},Object(r.b)(["userInfo"]),{allData:function(){var t={};return t.business=this.data.businessList,t.contacts=this.data.contactsList,t.contract=this.data.contractList,t.customer=this.data.customerList,t},allDataShow:function(){return 0!=this.data.businessList.length||0!=this.data.contactsList.length||0!=this.data.contractList.length||0!=this.data.customerList.length}}),watch:{},data:function(){return{commentsTextarea:"",childCommentsTextarea:"",commentsPopover:!1,replyChildComment:null,replyChildIndex:-1,childCommentsPopover:!1,blurIndex:0,contentLoading:!1,parentTarget:null,awaitMoment:!1,replyList:[]}},props:{data:Object,logIndex:{type:Number,default:0},showWorkbench:{type:Boolean,default:!1}},mounted:function(){var t=this;0!=this.data.isRead||this.showWorkbench||this.$bus.on("journal-list-box-scroll",function(e){if(0==t.data.isRead){e&&(t.parentTarget=e);var a=t.whetherPreview();!t.awaitMoment&&a&&(t.awaitMoment=!0,setTimeout(function(){t.awaitMoment=!1,t.whetherPreview()&&t.submiteIsRead()},3e3))}}),this.replyList=this.data.replyList},methods:{whetherPreview:function(){var t=this.parentTarget.children[this.logIndex];if(this.parentTarget.getBoundingClientRect()){var e=this.parentTarget.getBoundingClientRect().top-t.getBoundingClientRect().top,a=!1;return e<=0&&Math.abs(e)<this.parentTarget.clientHeight?a=!0:e>0&&e<t.clientHeight&&(a=!0),a}return!1},submiteIsRead:function(){var t=this;Object(l.e)({logId:this.showWorkbench?this.data.actionId:this.data.logId}).then(function(e){t.data.isRead=1}).catch(function(t){})},getCommentList:function(){var t=this;Object(o.b)({typeId:this.data.logId,type:1}).then(function(e){t.replyList=e.data}).catch(function(){})},verifyAwaitInfo:function(){},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})},checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})},discussDelete:function(t,e,a){var s=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.a)({commentId:t.commentId}).then(function(t){s.$message({type:"success",message:"删除成功!"}),e.splice(a,1),s.$emit("on-handle",{type:"discuss-delete",data:{item:s.data}})})}).catch(function(){s.$message({type:"info",message:"已取消删除"})})},discussBtn:function(t,e){t.show?(this.$set(t,"show",!1),this.replyChildComment=null):(this.$set(t,"show",!0),this.$set(t,"showComment",!1),this.replyChildComment=t,this.replyChildIndex=e)},childCommentSubmit:function(){var t=this;if(this.replyChildComment&&this.childCommentsTextarea){var e=-1==this.replyChildIndex?this.replyChildComment:this.replyChildComment.childCommentList[this.replyChildIndex];this.contentLoading=!0,Object(o.c)({pid:e.userId,typeId:e.typeId,mainId:0==e.mainId?e.commentId:e.mainId,type:2,content:this.childCommentsTextarea}).then(function(a){t.childCommentsPopover=!1,a.data.user=t.userInfo,a.data.replyUser=e.user,t.replyChildComment.childCommentList.push(a.data),t.$message.success("回复成功"),t.replyChildComment.show=!1,t.replyChildComment=null,t.contentLoading=!1,t.childCommentsTextarea="",t.$emit("on-handle",{type:"discuss-submit",data:{item:t.data}})}).catch(function(e){t.$message.error("回复失败"),t.contentLoading=!1})}},commentSubmit:function(){var t=this;this.commentsTextarea&&(this.contentLoading=!0,Object(o.c)({typeId:this.showWorkbench?this.data.actionId:this.data.logId,type:2,content:this.commentsTextarea}).then(function(e){t.$set(t.data,"showComment",!1),e.data.childCommentList=[],e.data.show=!1,e.data.user=t.userInfo,t.replyList.push(e.data),t.commentsTextarea="",t.$message.success("回复成功"),t.contentLoading=!1}).catch(function(e){t.$message.error("回复失败"),t.contentLoading=!1}))},commentBtn:function(t){t.showComment?this.$set(t,"showComment",!1):(this.replyChildComment&&(this.replyChildComment.show=!1),this.$set(t,"showComment",!0))},selectEmoji:function(t){var e=this.commentsTextarea.split("");e.splice(this.blurIndex,0,t),this.commentsTextarea=e.join(""),this.commentsPopover=!1},childSelectEmoji:function(t){var e=this.childCommentsTextarea.split("");e.splice(this.blurIndex,0,t),this.childCommentsTextarea=e.join(""),this.childCommentsPopover=!1},blurFun:function(t){this.blurIndex=t.target.selectionEnd},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,a){return{url:t.filePath,name:t.name}})})}},beforeDestroy:function(){this.$bus.off("journal-list-box-scroll")}},m=(a("Bc4i"),a("ZrdR")),h=Object(m.a)(u,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list",attrs:{id:"journal-cell"+t.logIndex}},[s("div",{staticClass:"list-content"},[s("div",{staticClass:"header"},[s("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],key:t.data.createUser.img,staticClass:"div-photo head-img header-circle"}),t._v(" "),s("div",{staticClass:"row"},[s("p",{staticClass:"row-title"},[s("span",{staticClass:"name"},[t._v(t._s(t.data.createUser.realname))]),t._v(" "),t.showWorkbench?s("span",{staticClass:"item-content"},[t._v(t._s(t.data.actionContent))]):s("span",{staticClass:"read",style:{color:0==t.data.isRead?"#3E84E9":"#ccc"}},[t._v(t._s(0==t.data.isRead?"未读":"已读"))])]),t._v(" "),s("span",{staticClass:"time"},[t._v(t._s(t._f("moment")(t.data.createTime,"YYYY-MM-DD HH:mm")))]),t._v(" "),s("el-tooltip",{attrs:{disabled:!(t.data.sendUserList.length>0||t.data.sendDeptList.length>0),placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"members-dep-title"},[t.data.sendUserList?s("span",t._l(t.data.sendUserList,function(e,a){return s("span",{key:a},[t._v("\n                  "+t._s(0==t.data.sendDeptList.length&&a==t.data.sendUserList.length-1?e.realname:e.realname+"，")+"\n                ")])})):t._e(),t._v(" "),t._l(t.data.sendDeptList,function(e,a){return 0!=t.data.sendDeptList.legnth?s("span",{key:a},[t._v("\n                "+t._s(a==t.data.sendDeptList.length-1?e.name:e.name+"，")+"\n              ")]):t._e()})],2)]),t._v(" "),s("p",{staticClass:"row-title",staticStyle:{display:"inline-block"}},[t.data.sendDeptList?s("span",[t._v(t._s(t.data.sendDeptList.length)+" 个部门，")]):t._e(),t._v(" "),t.data.sendUserList?s("span",[t._v(t._s(t.data.sendUserList.length)+"个同事")]):t._e()])])],1),t._v(" "),!t.showWorkbench&&t.data.permission&&(t.data.permission.isUpdate||t.data.permission.isDelete)?s("div",{staticClass:"rt-setting"},[s("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[s("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),t._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.data.permission.isUpdate?s("el-dropdown-item",{attrs:{command:"edit"}},[t._v("编辑")]):t._e(),t._v(" "),t.data.permission.isDelete?s("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")]):t._e()],1)],1)],1):t._e()]),t._v(" "),s("div",{staticClass:"text"},[t.data.content?s("p",{staticClass:"row"},[s("span",{staticClass:"title"},[t._v(t._s(1==t.data.categoryId?"今日工作内容":2==t.data.categoryId?"本周工作内容":"本月工作内容")+"：")]),t._v("\n        "+t._s(t.data.content)+"\n      ")]):t._e(),t._v(" "),t.data.tomorrow?s("p",{staticClass:"row"},[s("span",{staticClass:"title"},[t._v(t._s(1==t.data.categoryId?"明日工作内容":2==t.data.categoryId?"下周工作内容":"下月工作内容")+"：")]),t._v("\n        "+t._s(t.data.tomorrow)+"\n      ")]):t._e(),t._v(" "),t.data.question?s("p",{staticClass:"row"},[s("span",{staticClass:"title"},[t._v("遇到的问题：")]),t._v("\n        "+t._s(t.data.question)+"\n      ")]):t._e()]),t._v(" "),s("div",{staticClass:"accessory"},[0!=t.data.img.length?s("div",{staticClass:"upload-img-box"},t._l(t.data.img,function(e,a){return s("div",{key:a,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.data.img,a)}}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.filePath,expression:"imgItem.filePath"}],key:e.filePath})])})):t._e(),t._v(" "),0!=t.data.file.length?s("div",{staticClass:"accessory-box"},t._l(t.data.file,function(t,e){return s("file-cell",{key:e,attrs:{data:t,cellIndex:e}})})):t._e()]),t._v(" "),t.allDataShow?s("related-business",{attrs:{marginLeft:"0",alterable:!1,allData:t.allData},on:{checkRelatedDetail:t.checkRelatedDetail}}):t._e(),t._v(" "),t.replyList&&0!=t.replyList.length?s("div",{staticClass:"discuss"},[s("div",{staticClass:"border"}),t._v(" "),t._l(t.replyList,function(e,i){return s("div",{key:i,staticClass:"discuss-list"},[s("div",{directives:[{name:"photo",rawName:"v-photo",value:e.user,expression:"discussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.user.img),expression:"$options.filters.filterUserLazyImg(discussItem.user.img)",arg:"background-image"}],key:e.user.img,staticClass:"div-photo head-img header-circle"}),t._v(" "),s("span",{staticClass:"name"},[t._v(t._s(e.user.realname))]),t._v(" "),s("span",{staticClass:"time"},[t._v(t._s(e.createTime))]),t._v(" "),s("div",{staticClass:"rt"},[s("span",{on:{click:function(a){t.discussDelete(e,t.replyList,i)}}},[t._v("删除")]),t._v(" "),s("span",{on:{click:function(a){t.discussBtn(e,-1)}}},[t._v("回复")])]),t._v(" "),s("p",{staticClass:"reply-title"},[s("span",{domProps:{innerHTML:t._s(t.emoji(e.content))}})]),t._v(" "),e.childCommentList&&e.childCommentList.length>0?s("div",{staticClass:"children-reply"},t._l(e.childCommentList,function(a,i){return s("div",{key:i,staticClass:"discuss-list"},[s("div",{directives:[{name:"photo",rawName:"v-photo",value:a.user,expression:"childDiscussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(a.user.img),expression:"$options.filters.filterUserLazyImg(childDiscussItem.user.img)",arg:"background-image"}],key:a.user.img,staticClass:"div-photo head-img header-circle"}),t._v(" "),s("span",{staticClass:"name"},[t._v(t._s(a.user.realname))]),t._v(" "),s("span",{staticClass:"time"},[t._v(t._s(a.createTime))]),t._v(" "),s("div",{staticClass:"rt"},[s("span",{on:{click:function(s){t.discussDelete(a,e.childCommentList,i)}}},[t._v("删除")]),t._v(" "),s("span",{on:{click:function(a){t.discussBtn(e,i)}}},[t._v("回复")])]),t._v(" "),s("p",{staticClass:"reply-title"},[[s("span",[t._v("回复")]),t._v(" "),a.replyUser?s("span",{staticClass:"reply"},[t._v("@"+t._s(a.replyUser.realname)+"：")]):t._e()],t._v(" "),s("span",{domProps:{innerHTML:t._s(t.emoji(a.content))}})],2)])})):t._e(),t._v(" "),e.show?s("div",{staticClass:"comment-box"},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},on:{blur:t.blurFun},model:{value:t.childCommentsTextarea,callback:function(e){t.childCommentsTextarea=e},expression:"childCommentsTextarea"}}),t._v(" "),s("div",{staticClass:"btn-group"},[s("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.childCommentsPopover,callback:function(e){t.childCommentsPopover=e},expression:"childCommentsPopover"}},[s("emoji",{on:{select:t.childSelectEmoji}}),t._v(" "),s("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:a("woiz")},slot:"reference"})],1),t._v(" "),s("div",{staticClass:"btn-box"},[s("el-button",{attrs:{type:"primary",loading:t.contentLoading},on:{click:function(e){t.childCommentSubmit()}}},[t._v("回复")]),t._v(" "),s("el-button",{on:{click:function(t){e.show=!1}}},[t._v("取消")])],1)],1)],1):t._e(),t._v(" "),s("div",{staticClass:"border"})])})],2):t._e()],1),t._v(" "),s("div",{staticClass:"footer"},[s("span",{staticClass:"comment",on:{click:function(e){t.commentBtn(t.data)}}},[t._v("回复")])]),t._v(" "),t.data.showComment?s("div",{staticClass:"comment-box"},[s("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},on:{blur:t.blurFun},model:{value:t.commentsTextarea,callback:function(e){t.commentsTextarea=e},expression:"commentsTextarea"}}),t._v(" "),s("div",{staticClass:"btn-group"},[s("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.commentsPopover,callback:function(e){t.commentsPopover=e},expression:"commentsPopover"}},[s("emoji",{on:{select:t.selectEmoji}}),t._v(" "),s("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:a("woiz")},slot:"reference"})],1),t._v(" "),s("div",{staticClass:"btn-box"},[s("el-button",{attrs:{type:"primary",loading:t.contentLoading},on:{click:function(e){t.commentSubmit()}}},[t._v("回复")]),t._v(" "),s("el-button",{on:{click:function(e){t.data.showComment=!1}}},[t._v("取消")])],1)],1)],1):t._e()])},[],!1,null,"87ea9f3c",null);h.options.__file="journalCell.vue";e.a=h.exports},J2yD:function(t,e,a){"use strict";var s=a("LKkS");a.n(s).a},Jkmh:function(t,e,a){"use strict";var s=a("e2fa");a.n(s).a},JnXs:function(t,e,a){var s=a("Rx2n");s(s.S+s.F*!a("aQoo"),"Object",{defineProperty:a("TPTJ").f})},LKkS:function(t,e,a){},N0PQ:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZGRjBCRTYxRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZGRjBCRTYyRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkZGMEJFNUZFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkZGMEJFNjBFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz704RrgAAABwUlEQVR42uSXz0sCQRTH36h1sGNlaHjpVJoHC0KCOnVJOwSdqmM/6NZ/EF071rluQaduGQWd9BZEqWBhQQQmHYIQikDU6bs6G8Oy4q7sskYPPuzOzFu+++a9mZ1lnHNywlzkkDkm7JEb7/m8rWIDoVBHEc+DEuAaSmLMtqk+An6dfr8Ys0T4BHxJUbUzJq6q/yc47kR4CXg1fevgTcf3Faxp+vrAsuHikqxH054A5y2mWvYxnEaPwZTc/Kl1zJPJBt27gbR667YlnUjYMNWMORMxi8edETZhH+AZ9IIx4LZb+A5sieskGALfYMWW4hIFdQtmwJyIVt5gruEziucfrF5OVbAKZsGpzq42BVIQH+6suFovlRRQojnTzWethl73IO52wYaVEd+DcTDSaFUqRPV6c6RYJJ5ON8WJFqwuLkWl/7cWMhmE4SLm8xHP5YhFIkrEJPsYibhqQDgKCur3moXDROUy8Wy2KRoMqn5PZoQLBoSnxTf7otHyeonFYsSiUVlUsUMzwttAOfnV2my3e2ATvKjiFAjIPpdg30yOr0DYRL6VpbMDFoEPPIpz2EGrl2fyn0S3Hm8tNfbv/p1+BBgA+Vdv2Iz9D6cAAAAASUVORK5CYII="},NxN7:function(t,e,a){"use strict";var s=a("a3e5");a.n(s).a},O1Uw:function(t,e,a){"use strict";var s=a("7Qib"),i=a("KTTK"),n={name:"file-cell",computed:{},watch:{},data:function(){return{}},props:{cellIndex:Number,data:Object,showFoot:{type:Boolean,default:!0},cursorPointer:{type:Boolean,default:!1},showDelete:{type:Boolean,default:!1},module_id:[String,Number]},mounted:function(){},methods:{downloadClick:function(){Object(s.a)({path:this.data.filePath,name:this.data.name})},deleteClick:function(){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.c)({id:t.data.fileId}).then(function(e){t.$message.success("操作成功"),t.$emit("delete",t.cellIndex,t.data)}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}},beforeDestroy:function(){}},l=(a("q6+h"),a("ZrdR")),o=Object(l.a)(n,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("flexbox",{staticClass:"cell"},[s("img",{staticClass:"cell-head",attrs:{src:a("6KEE"),alt:""}}),t._v(" "),s("div",{staticClass:"cell-body",class:{"cursor-pointer":t.cursorPointer}},[s("span",[t._v(t._s(t.data.name))]),t._v(" "),s("span",{staticClass:"size"},[t._v("("+t._s(t.data.size)+")")])]),t._v(" "),s("div",{staticClass:"cell-foot"},[s("i",{staticClass:"el-icon-download",on:{click:t.downloadClick}}),t._v(" "),t.showDelete?s("i",{staticClass:"el-icon-delete",on:{click:t.deleteClick}}):t._e()])])},[],!1,null,"238c5044",null);o.options.__file="index.vue";e.a=o.exports},OPCT:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVENDNERTkxRTA5QjExRThBQkRDQjRERjVBMjY3MzE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVENDNERTkyRTA5QjExRThBQkRDQjRERjVBMjY3MzE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NUQ0M0RFOEZFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NUQ0M0RFOTBFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7c1/V2AAABIElEQVR42mL8//8/AwicPXuWgVxgbGwMZzMRUBsGxBeB+AXITigfL2DBIxcCxHlA7AnEz4CYB4gnQ+VW4dKEz4UNQBwNNQwEvgBxBhAn4XMhPgMFgPghmthPIP5NroF/cYgzkmsgMw7x/+Qa+AGIZbBEIgu5BjYC8VIgloLyQbE8E4gXkJtsVkMt3Ak1DOTiDiBeSa6BDFDNK0nJNdi8rArEa4H4IzQC0PFHqLwqMQaqA/ERID4IxIrQJIKOFaDyR6Dq8Xq5DYon4fHVe6g8J1RtMD4XugDxYiKDazYQu5GSbMgC6AbuAeJYIvWmAPEuQmFYDQ3w/1Cvv8dikCDU0mIgtifkwhtAbAdV+BBHsnkIlbeDqieYsG+ixxwpACDAAIZEQR7SM/O0AAAAAElFTkSuQmCC"},Op00:function(t,e,a){"use strict";var s=a("+9th"),i={name:"task-cell",components:{},mixins:[],computed:{},watch:{},data:function(){return{}},props:{data:Object,dataIndex:Number},mounted:function(){},methods:{taskOverClick:function(t){Object(s.g)({taskId:t.taskId,status:t.checked?5:1}).then(function(t){}).catch(function(e){t.checked=!1})},rowFun:function(t){this.$emit("on-handle",{type:"view",data:{item:this.data,index:this.dataIndex}})},onmouseoverFun:function(t){this.$refs.itemSpan.offsetWidth>this.$refs.listLeft.offsetWidth-21?this.$set(t,"show",!0):this.$set(t,"show",!1)}}},n=(a("OvEQ"),a("ZrdR")),l=Object(n.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"taskRow",staticClass:"list",style:{"border-left-color":1==t.data.priority?"#8bb5f0":2==t.data.priority?"#FF9668":3==t.data.priority?"#ED6363":"transparent"},on:{click:function(e){t.rowFun(t.data)}}},[a("div",{ref:"listLeft",staticClass:"list-left"},[a("div",{class:t.data.checked?"title title-active":"title",on:{click:function(t){t.stopPropagation()}}},[a("el-checkbox",{on:{change:function(e){t.taskOverClick(t.data)}},model:{value:t.data.checked,callback:function(e){t.$set(t.data,"checked",e)},expression:"data.checked"}})],1),t._v(" "),a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"task-tooltip tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(t.data.name))])]),t._v(" "),a("span",{ref:"itemSpan",class:t.data.checked?"item-name-active":"item-name"},[t._v("\n        "+t._s(t.data.name)+"\n      ")])])],1),t._v(" "),a("div",{staticClass:"list-right"},[t.data.labelList&&t.data.labelList.length>0?a("div",{staticClass:"tag-box"},[t.data.labelList.length<=2?t._l(t.data.labelList,function(e,s){return a("div",{key:s,staticClass:"item-label"},[a("span",{staticClass:"k-name",style:{background:e.color}},[t._v(t._s(e.lableName))])])}):[a("span",{staticClass:"k-name",style:{background:t.data.labelList[0].color}},[t._v(t._s(t.data.labelList[0].lableName))]),t._v(" "),a("span",{staticClass:"k-name",style:{background:t.data.labelList[1].color}},[t._v(t._s(t.data.labelList[1].lableName))]),t._v(" "),a("el-tooltip",{attrs:{placement:"top",effect:"light","popper-class":"tooltip-change-border task-tooltip"}},[a("div",{staticClass:"tooltip-content",staticStyle:{margin:"10px 10px 10px 0"},attrs:{slot:"content"},slot:"content"},t._l(t.data.labelList,function(e,s){return a("div",{key:s,staticClass:"item-label",staticStyle:{display:"inline-block","margin-right":"10px"}},[s>=2?a("span",{staticClass:"k-name",staticStyle:{"border-radius":"3px",color:"#FFF",padding:"3px 10px"},style:{background:e.color||"#ccc"}},[t._v(t._s(e.lableName))]):t._e()])})),t._v(" "),a("span",{staticClass:"color-label-more"},[a("i",[t._v("...")])])])]],2):t._e(),t._v(" "),a("div",{staticClass:"img-group"},[t.data.relationCount?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-relevance"}),t._v(" "),a("span",[t._v(t._s(t.data.relationCount))])]):t._e(),t._v(" "),t.data.childAllCount>0?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-sub-task"}),t._v(" "),a("span",[t._v(t._s(t.data.childWCCount)+"/"+t._s(t.data.childAllCount))])]):t._e(),t._v(" "),t.data.fileCount?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-file"}),t._v(" "),a("span",[t._v(t._s(t.data.fileCount))])]):t._e(),t._v(" "),t.data.commentCount?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-comment-task"}),t._v(" "),a("span",[t._v(t._s(t.data.commentCount))])]):t._e(),t._v(" "),t.data.stopTime?a("div",{staticClass:"img-box"},[a("i",{staticClass:"wukong wukong-time-task",style:{color:1!=t.data.isEnd||t.data.checked?"#999":"red"}}),t._v(" "),a("span",{style:{color:1!=t.data.isEnd||t.data.checked?"#999":"red"}},[t._v(t._s(t._f("moment")(t.data.stopTime,"MM-DD"))+" 截止")])]):t._e()]),t._v(" "),a("div",{staticClass:"item-own-box"},[t.data.mainUser&&t.data.mainUser.id?a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(t.data.mainUser.realname))])]),t._v(" "),a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.mainUser,expression:"data.mainUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.mainUser.img),expression:"$options.filters.filterUserLazyImg(data.mainUser.img)",arg:"background-image"}],staticClass:"div-photo"})]):t._e()],1)])])},[],!1,null,"5ec41758",null);l.options.__file="taskCell.vue";e.a=l.exports},OvEQ:function(t,e,a){"use strict";var s=a("xw4X");a.n(s).a},QJC7:function(t,e,a){"use strict";var s=a("7Qib"),i={name:"follow-record-cell",components:{CRMFullScreenDetail:function(){return Promise.all([a.e("chunk-0005"),a.e("chunk-276e"),a.e("chunk-162a"),a.e("chunk-26b2"),a.e("chunk-2ce5c5")]).then(a.bind(null,"uMjE"))}},props:{item:{type:Object,default:function(){return{}}},crmType:{type:String,default:""}},data:function(){return{showFullDetail:!1,relationID:"",relationCrmType:""}},computed:{},mounted:function(){},methods:{previewImg:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,a){return t.url=t.filePath,t})})},downloadFile:function(t){Object(s.a)({path:t.filePath,name:t.name})},checkRelationDetail:function(t,e){this.relationID=e,this.relationCrmType=t,this.showFullDetail=!0}}},n=(a("DhPt"),a("ZrdR")),l=Object(n.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"fl-c"},[s("flexbox",{staticClass:"fl-h"},[s("div",{directives:[{name:"photo",rawName:"v-photo",value:{img:t.item.userImg,realname:t.item.realname},expression:"{img: item.userImg, realname: item.realname}"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.item.userImg),expression:"$options.filters.filterUserLazyImg(item.userImg)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),t._v(" "),s("div",{staticClass:"fl-h-b"},[s("div",{staticClass:"fl-h-name"},[t._v(t._s(t.item.realname))]),t._v(" "),s("div",{staticClass:"fl-h-time"},[t._v(t._s(t.item.createTime))])]),t._v(" "),s("flexbox",{staticClass:"fl-h-mark"},[s("img",{staticClass:"fl-h-mark-img",attrs:{src:a("N0PQ")}}),t._v(" "),s("div",{staticClass:"fl-h-mark-name"},[t._v("跟进记录")])])],1),t._v(" "),s("div",{staticClass:"fl-b"},[s("div",{staticClass:"fl-b-content"},[t._v(t._s(t.item.content))]),t._v(" "),t.item.img&&t.item.img.length>0?s("flexbox",{staticClass:"fl-b-images",attrs:{wrap:"wrap"}},t._l(t.item.img,function(e,a){return s("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:e.filePath,expression:"file.filePath",arg:"background-image"}],key:e.filePath,staticClass:"fl-b-img-item",on:{click:function(e){t.previewImg(t.item.img,a)}}})})):t._e(),t._v(" "),t.item.file&&t.item.file.length>0?s("div",{staticClass:"fl-b-files"},t._l(t.item.file,function(e,i){return s("flexbox",{key:i,staticClass:"cell"},[s("img",{staticClass:"cell-head",attrs:{src:a("6KEE")}}),t._v(" "),s("div",{staticClass:"cell-body"},[t._v(t._s(e.name)),s("span",{staticStyle:{color:"#ccc"}},[t._v("（"+t._s(e.size)+"）")])]),t._v(" "),s("i",{staticClass:"el-icon-download cell-foot",staticStyle:{cursor:"pointer",color:"#ccc"},on:{click:function(a){t.downloadFile(e)}}})])})):t._e(),t._v(" "),t.item.category||t.item.nextTime?s("div",{staticClass:"follow"},[t.item.category?s("span",{staticClass:"follow-info"},[t._v(t._s(t.item.category))]):t._e(),t._v(" "),t.item.nextTime?s("span",{staticClass:"follow-info"},[t._v(t._s(t.item.nextTime))]):t._e()]):t._e(),t._v(" "),t.item.contactsList&&t.item.contactsList.length>0?s("div",{staticClass:"fl-b-other"},[s("div",{staticClass:"fl-b-other-name"},[t._v("关联联系人")]),t._v(" "),s("div",t._l(t.item.contactsList,function(e,a){return s("flexbox",{key:a,staticClass:"cell",nativeOn:{click:function(a){t.checkRelationDetail("contacts",e.contactsId)}}},[s("i",{staticClass:"wukong wukong-contacts cell-head crm-type",style:{opacity:0==a?1:0}}),t._v(" "),s("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.name))])])}))]):t._e(),t._v(" "),t.item.businessList&&t.item.businessList.length>0?s("div",{staticClass:"fl-b-other"},[s("div",{staticClass:"fl-b-other-name"},[t._v("关联商机")]),t._v(" "),s("div",t._l(t.item.businessList,function(e,a){return s("flexbox",{key:a,staticClass:"cell",nativeOn:{click:function(a){t.checkRelationDetail("business",e.businessId)}}},[s("i",{staticClass:"wukong wukong-business cell-head crm-type",style:{opacity:0==a?1:0}}),t._v(" "),s("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.businessName))])])}))]):t._e()],1),t._v(" "),s("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,crmType:t.relationCrmType,id:t.relationID},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"58f3e910",null);l.options.__file="FollowRecordCell.vue";var o=l.exports,c=a("5tgW"),r=a("vG5h"),d=a("qbf4"),u=a("UcQx"),m=a("6zBA"),h={name:"record-log",components:{FollowRecordCell:o},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(t){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},mounted:function(){var t=this;this.$bus.on("follow-log-refresh",function(e){"record-log"==e.type&&t.refreshList()});var e=this,a=document.getElementById("follow-log-content");a.onscroll=function(){a.scrollTop+a.clientHeight==a.scrollHeight&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0;var e={customer:r.o,leads:c.g,contacts:d.d,business:u.f,contract:m.f}[this.crmType],a={page:this.page,limit:10};a[this.crmType+"Id"]=this.id,e(a).then(function(e){t.list=t.list.concat(e.data),e.data.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()}},beforeDestroy:function(){this.$bus.off("follow-log-refresh")}},p=(a("rGfU"),Object(n.a)(h,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[a("div",{staticClass:"log-items"},[t._l(t.list,function(e,s){return a("follow-record-cell",{key:s,attrs:{item:e,crmType:t.crmType}})}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)])])},[],!1,null,"72fa2d19",null));p.options.__file="RecordLog.vue";e.a=p.exports},Qldq:function(t,e,a){"use strict";a.d(e,"d",function(){return i}),a.d(e,"a",function(){return n}),a.d(e,"c",function(){return l}),a.d(e,"b",function(){return o}),a.d(e,"e",function(){return c});var s=a("t3Un");function i(t){return Object(s.a)({url:"OaLog/queryList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function n(t){return Object(s.a)({url:"OaLog/addOrUpdate",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function l(t){return Object(s.a)({url:"OaLog/addOrUpdate",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function o(t){return Object(s.a)({url:"OaLog/deleteById",method:"post",data:t})}function c(t){return Object(s.a)({url:"OaLog/readLog",method:"post",data:t})}},R0bQ:function(t,e,a){},S3Kq:function(t,e,a){"use strict";var s=a("EPZ6"),i=a.n(s),n=a("sCIN"),l={name:"emoji",data:function(){return{emojiData:n.a,pannels:["表情","自然","物品","地点","符号"],activeIndex:0}},created:function(){},methods:{changeActive:function(t){this.activeIndex=t},getPureName:function(t){return t.replace(/:/g,"")},selectItem:function(t){this.$emit("select",t)}},computed:{emojis:function(){var t=this;return this.pannels.map(function(e){return i()(t.emojiData[e])})}}},o=(a("Jkmh"),a("ZrdR")),c=Object(o.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"emoji"},[a("ul",{staticClass:"emoji-controller"},t._l(t.pannels,function(e,s){return a("li",{key:s,class:{active:s===t.activeIndex},on:{click:function(e){t.changeActive(s)}}},[t._v("\n      "+t._s(e)+"\n    ")])})),t._v(" "),a("ul",{staticClass:"emoji-container"},t._l(t.emojis,function(e,s){return s===t.activeIndex?a("li",{key:s,staticStyle:{padding:"0"}},[t._v("\n      "+t._s(e)+"--"+t._s(s)+"\n      "),t._l(e,function(e,s){return a("a",{key:s,attrs:{href:"javascript:;"},on:{click:function(a){t.selectItem(e)}}},[a("span",{staticClass:"emoji-item",class:"sprite-"+t.getPureName(e),attrs:{title:e}})])})],2):t._e()}))])},[],!1,null,"f42c84dc",null);c.options.__file="emoji.vue";e.a=c.exports},UEWd:function(t,e,a){"use strict";var s=a("7Qib"),i=a("KTTK"),n={name:"mix-add",components:{CrmRelative:a("mkuN").a},props:{showRelativeBusiness:{type:Boolean,default:!1},showRelativeContacts:{type:Boolean,default:!1},id:[String,Number],crmType:{type:String,default:""}},data:function(){return{content:"",inputAutosize:{minRows:1,maxRows:6},barItems:[{img:a("S1Xc"),title:"图片",type:"img",data:"image/*"},{img:a("rl4O"),title:"附件",type:"file",data:"*.*"}],imgFiles:[],files:[],business:[],contacts:[],showRelativeType:"",batchId:""}},computed:{},mounted:function(){this.showRelativeBusiness&&this.barItems.push({img:a("i91G"),title:"关联商机",type:"business",show:!1}),this.showRelativeContacts&&this.barItems.push({img:a("OPCT"),title:"关联联系人",type:"contacts",show:!1}),this.$on("submit-info",function(){this.$emit("mixadd-info",{content:this.content,files:this.files,images:this.imgFiles,business:this.business,contacts:this.contacts,batchId:this.batchId})})},methods:{resetInfo:function(){this.content="",this.imgFiles=[],this.files=[],this.business=[],this.contacts=[],this.showRelativeType="",this.batchId=""},checkRelativeInfos:function(t){"business"==this.showRelativeType?this.business=t.data:"contacts"==this.showRelativeType&&(this.contacts=t.data)},barClick:function(t){"business"==t.type?(this.showRelativeType=t.type,t.show=!0):"contacts"==t.type&&(this.showRelativeType=t.type,t.show=!0)},uploadFile:function(t){var e=this,a=t.target.files;if(a.length){var s="image/*"==t.target.accept?"img":"file",i=a[0];this.sendFileRequest(i,s,function(){for(var i=1;i<a.length;i++){var n=a[i];e.sendFileRequest(n,s)}t.target.value=""})}},sendFileRequest:function(t,e,a){var n=this,l={file:t,type:e};this.batchId&&(l.batchId=this.batchId),Object(i.e)(l).then(function(i){""==n.batchId&&(n.batchId=i.batchId),i.size=Object(s.c)(t.size),"img"==e?n.imgFiles.push(i):(i.icon=Object(s.f)(t),n.files.push(i)),a&&a()}).catch(function(){})},deleteAllImg:function(){this.imgFiles=[]},deleteImgOrFile:function(t,e,a){var s=this;Object(i.c)({id:e.fileId}).then(function(e){"image"==t?s.imgFiles.splice(a,1):s.files.splice(a,1),s.$message.success("操作成功")}).catch(function(){})},mouseImgOver:function(t,e){t.showDelete=!0,this.$set(this.imgFiles,e,t)},mouseImgLeave:function(t,e){t.showDelete=!1,this.$set(this.imgFiles,e,t)},inputFocus:function(){var t=this;this.inputAutosize={minRows:3,maxRows:6},this.$nextTick(function(){t.$refs.textarea.resizeTextarea()})}},beforeDestroy:function(){this.$off("submit-info")}},l=(a("37nJ"),a("ZrdR")),o=Object(l.a)(n,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mix-container"},[s("div",{staticClass:"i-cont"},[s("el-input",{ref:"textarea",attrs:{type:"textarea",autosize:t.inputAutosize,clearable:"",resize:"none",placeholder:"请输入内容"},on:{focus:t.inputFocus},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),t._v(" "),t.imgFiles.length>0?s("section",{staticClass:"img-cont"},[s("flexbox",{attrs:{wrap:"wrap"}},[t._l(t.imgFiles,function(e,a){return s("div",{key:a,staticClass:"img-item",style:{"background-image":"url("+e.url+")"},on:{mouseover:function(s){t.mouseImgOver(e,a)},mouseleave:function(s){t.mouseImgLeave(e,a)}}},[e.showDelete?s("div",{staticClass:"img-delete",on:{click:function(s){t.deleteImgOrFile("image",e,a)}}},[t._v("×")]):t._e()])}),t._v(" "),s("div",{staticClass:"img-item-add"},[s("input",{staticClass:"img-item-iput",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.uploadFile}})])],2),t._v(" "),s("div",{staticClass:"img-bar",on:{click:t.deleteAllImg}},[t._v("全部删除")])],1):t._e(),t._v(" "),t.files.length>0?s("section",{staticClass:"file-cont"},[s("flexbox",{staticClass:"f-header"},[s("img",{staticClass:"f-logo",attrs:{src:a("rl4O")}}),t._v(" "),s("div",{staticClass:"f-name"},[t._v("附件")])]),t._v(" "),s("div",{staticClass:"f-body"},t._l(t.files,function(e,a){return s("flexbox",{key:a,staticClass:"f-item"},[s("img",{staticClass:"f-img",attrs:{src:e.icon}}),t._v(" "),s("div",{staticClass:"f-name"},[t._v(t._s(e.name+"("+e.size+")"))]),t._v(" "),s("div",{staticClass:"close-button",on:{click:function(s){t.deleteImgOrFile("file",e,a)}}},[t._v("×")])])})),t._v(" "),s("div",{staticClass:"img-bar",on:{click:function(e){t.files=[]}}},[t._v("全部删除")])],1):t._e(),t._v(" "),t.business.length>0?s("section",{staticClass:"c-cont"},[s("flexbox",{staticClass:"c-header"},[s("img",{staticClass:"c-logo",attrs:{src:a("i91G")}}),t._v(" "),s("div",{staticClass:"c-name"},[t._v("商机")])]),t._v(" "),s("div",{staticClass:"c-body"},[s("flexbox",{attrs:{wrap:"wrap"}},t._l(t.business,function(e,a){return s("flexbox",{key:a,staticClass:"c-item"},[s("div",{staticClass:"c-item-name"},[t._v(t._s(e.businessName))]),t._v(" "),s("div",{staticClass:"c-item-close",on:{click:function(e){t.business.splice(a,1)}}},[t._v("×")])])}))],1)],1):t._e(),t._v(" "),t.contacts.length>0?s("section",{staticClass:"c-cont"},[s("flexbox",{staticClass:"c-header"},[s("img",{staticClass:"c-logo",attrs:{src:a("OPCT")}}),t._v(" "),s("div",{staticClass:"c-name"},[t._v("联系人")])]),t._v(" "),s("div",{staticClass:"c-body"},[s("flexbox",{attrs:{wrap:"wrap"}},t._l(t.contacts,function(e,a){return s("flexbox",{key:a,staticClass:"c-item"},[s("div",{staticClass:"c-item-name"},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"c-item-close",on:{click:function(e){t.contacts.splice(a,1)}}},[t._v("×")])])}))],1)],1):t._e(),t._v(" "),s("flexbox",{staticClass:"bar-cont"},[t._l(t.barItems,function(e,a){return["img"==e.type||"file"==e.type?s("flexbox",{key:a,staticClass:"bar-item",nativeOn:{click:function(a){t.barClick(e)}}},[s("input",{staticClass:"bar-input",attrs:{type:"file",accept:e.data,multiple:""},on:{change:t.uploadFile}}),t._v(" "),s("img",{staticClass:"bar-img",attrs:{src:e.img}}),t._v(" "),s("div",{staticClass:"bar-title"},[t._v(t._s(e.title))])]):s("el-popover",{key:a,attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.show,callback:function(a){t.$set(e,"show",a)},expression:"item.show"}},[s("crm-relative",{ref:"crmrelative",refInFor:!0,attrs:{show:e.show,radio:!1,action:{type:"condition",data:{moduleType:t.crmType,customerId:t.id}},selectedData:"business"==e.type?{business:t.business}:{contacts:t.contacts},"crm-type":e.type},on:{close:function(t){e.show=!1},changeCheckout:t.checkRelativeInfos}}),t._v(" "),s("flexbox",{staticClass:"bar-item",attrs:{slot:"reference"},nativeOn:{click:function(a){t.barClick(e)}},slot:"reference"},[s("img",{staticClass:"bar-img",attrs:{src:e.img}}),t._v(" "),s("div",{staticClass:"bar-title"},[t._v(t._s(e.title))])])],1)]})],2)],1)},[],!1,null,"4046b7aa",null);o.options.__file="MixAdd.vue";e.a=o.exports},VKxC:function(t,e,a){},VU1q:function(t,e,a){"use strict";var s=a("7ccD");a.n(s).a},W070:function(t,e,a){"use strict";var s=a("DBls");a.n(s).a},"X+yC":function(t,e,a){"use strict";var s=a("ozQO");a.n(s).a},Zuug:function(t,e,a){"use strict";var s=a("CT8I");a.n(s).a},a3e5:function(t,e,a){},"aQg/":function(t,e,a){"use strict";var s=a("d0bK"),i=a("Op00"),n=a("KzkL"),l=a("7Qib"),o={name:"task-log",components:{TaskCell:i.a,Particulars:function(){return Promise.all([a.e("chunk-0005"),a.e("chunk-276e"),a.e("chunk-162a"),a.e("chunk-d2ee")]).then(a.bind(null,"+Gvz"))}},props:{id:[String,Number],crmType:{type:String,default:""}},mixins:[s.a],watch:{id:function(t){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){e.scrollTop+e.clientHeight==e.scrollHeight&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0;var e={page:this.page,limit:10};e[this.crmType+"Ids"]=this.id,Object(n.m)(e).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},taskCellHandle:function(t){var e=this;"view"==t.type&&this.showDetailView(t.data.item,t.data.index,function(){e.$nextTick(function(){document.body.appendChild(e.$refs.taskShade),e.$refs.taskShade.style.zIndex=Object(l.g)(),e.$refs.taskShade.addEventListener("click",e.handleDocumentClick,!1)})})},handleDocumentClick:function(t){t.stopPropagation(),this.$refs.taskShade==t.target&&(this.taskDetailShow=!1)}}},c=(a("GIzo"),a("ZrdR")),r=Object(c.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[a("div",{staticClass:"log-items"},[t._l(t.list,function(e,s){return a("task-cell",{key:s,attrs:{data:e,dataIndex:s},on:{"on-handle":t.taskCellHandle}})}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),t.taskDetailShow?a("div",{ref:"taskShade",staticClass:"full-container"},[a("particulars",{staticClass:"d-view",attrs:{id:t.taskID,detailIndex:t.detailIndex},on:{"on-handle":t.detailHandle,close:t.closeBtn}})],1):t._e()])},[],!1,null,"583e1df0",null);r.options.__file="TaskLog.vue";e.a=r.exports},cEue:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjYzNEQ2RDE3MzRFNTExRTlCRjI5QUEzN0UzNDcxMUZDIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjYzNEQ2RDE4MzRFNTExRTlCRjI5QUEzN0UzNDcxMUZDIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NjM0RDZEMTUzNEU1MTFFOUJGMjlBQTM3RTM0NzExRkMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NjM0RDZEMTYzNEU1MTFFOUJGMjlBQTM3RTM0NzExRkMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4/GDLpAAABSElEQVR42oySvU4CURCFD/cVVHp+X0Cihp4QXkBXDBW/L0HCW0CgJGC0tSCEghJNtLDmr8ME9QUs0DPu3XXvLmaZ5BQ7d767c89M5LtehycUdUVdUxfUCfVOPVK31B21c4ojHjhO3VOn+D9eqEtq5fzJAWchIPT5TNf/wkq3E8VhEdX1SkCLyrhHrRYQi5nlySTQbHozUm8JXDIKBwOg0WBj8T+wWgWGQ38HJTFM3Dw20qkUUKkA4zGQzwPdLrBc+uE3FQAl5nNgMqGvNHY02gdKHAn8EUin00AuR1voS6EAJBL74E+BnwNguQx0OsB0CvR6QK1mv92MV4H7Rsqi+e02sF7b34uFfUGx6If7Yphc8GSMKzyk23Old1VmvT0Q3Or6nbOeYmdW7y5Cdjur693ddi44o+RxD9SG+pJ56u8bfe7O7UeAAQCsHFF+l0CFAgAAAABJRU5ErkJggg=="},d0bK:function(t,e,a){"use strict";e.a={components:{},data:function(){return{taskID:"",detailIndex:-1,taskDetailShow:!1}},mounted:function(){},methods:{closeBtn:function(){this.taskDetailShow=!1},showDetailView:function(t,e,a){this.taskID=t.taskId,this.detailIndex=e,this.taskDetailShow=!0,a&&a()},detailHandle:function(t){if(0==t.index||t.index)if("title-check"==t.type)this.$set(this.list[t.index],"checked",t.value);else if("delete"==t.type)this.list.splice(t.index,1);else if("change-stop-time"==t.type){parseInt(t.value)+86399>new Date(new Date).getTime()/1e3?this.list[t.index].isEnd=!1:this.list[t.index].isEnd=!0,this.list[t.index].stopTime=t.value}else if("change-priority"==t.type)this.list[t.index].priority=t.value.id;else if("change-name"==t.type)this.list[t.index].name=t.value;else if("change-comments"==t.type){var e=this.list[t.index].commentCount;"add"==t.value?this.list[t.index].commentCount=e+1:this.list[t.index].commentCount=e-1}else"change-sub-task"==t.type&&(this.list[t.index].childAllCount=t.value.subdonecount,this.list[t.index].childAllCount=t.value.allcount)}},deactivated:function(){}}},e22y:function(t,e,a){},e2fa:function(t,e,a){},fGWj:function(t,e,a){"use strict";var s=a("vnKs");a.n(s).a},faIZ:function(t,e,a){"use strict";var s=a("zukx");a.n(s).a},fm0C:function(t,e,a){},gd5k:function(t,e,a){"use strict";var s=a("Fpl1"),i=a("+zsY"),n=a("KzkL"),l=a("ExMk"),o=(a("7Qib"),{name:"examine-log",components:{ExamineCell:s.a,CRMFullScreenDetail:function(){return Promise.all([a.e("chunk-0005"),a.e("chunk-276e"),a.e("chunk-162a"),a.e("chunk-2ce5")]).then(a.bind(null,"uMjE"))},ExamineHandle:function(){return a.e("chunk-338f").then(a.bind(null,"QhmF"))},ExamineCreateView:i.a},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(t){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showExamineHandle:!1,isCreate:!1,createAction:{type:"save"},createInfo:{},showFullDetail:!1,detailCRMType:""}},computed:{},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){e.scrollTop+e.clientHeight==e.scrollHeight&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0;var e={page:this.page,limit:10};e[this.crmType+"Ids"]=this.id,Object(n.k)(e).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(t){var e=this;"edit"==t.type?(t.data.item.title=t.data.item.categoryName,this.createInfo=t.data.item,this.createAction={type:"update",id:t.data.item.examineId,data:t.data.item},this.isCreate=!0):"delete"==t.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.d)({examineId:t.data.item.examineId}).then(function(t){e.refreshList(),e.$message({type:"success",message:"删除成功!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):"withdraw"==t.type?(this.rowID=t.data.item.examineId,this.showExamineHandle=!0):"view"==t.type?(this.detailCRMType="examine",this.rowID=t.data.item.examineId,this.showFullDetail=!0):"related-detail"==t.type&&(this.rowID=t.data.item[t.data.type+"Id"],this.detailCRMType=t.data.type,this.showFullDetail=!0)}}}),c=(a("Zuug"),a("ZrdR")),r=Object(c.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[a("div",{staticClass:"log-items"},[t._l(t.list,function(e,s){return a("examine-cell",{key:s,attrs:{data:e},on:{"on-handle":t.examineCellHandle}})}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),a("examine-handle",{attrs:{show:t.showExamineHandle,id:t.rowID,examineType:"oa_examine",status:"2"},on:{close:function(e){t.showExamineHandle=!1},save:t.refreshList}}),t._v(" "),t.isCreate?a("examine-create-view",{attrs:{categoryId:t.createInfo.categoryId,categoryTitle:t.createInfo.title,action:t.createAction},on:{"save-success":t.refreshList,"hiden-view":function(e){t.isCreate=!1}}}):t._e(),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,crmType:t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"74f91bbb",null);r.options.__file="ExamineLog.vue";e.a=r.exports},ggbt:function(t,e,a){"use strict";var s=a("lsu2");a.n(s).a},hDuR:function(t,e,a){},hmIG:function(t,e,a){},i1an:function(t,e,a){},i91G:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU2RjI0NjM0RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU2RjI0NjM1RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTZGMjQ2MzJFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTZGMjQ2MzNFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4H2LzoAAAAnklEQVR42mI8c+YMA7WAsbExAxMDlQGygSuA+B8Q/8eD/0HV4QQsSOwwNAtwAZChEcS4kJFIXzES62WqhyFdDESOqH1ocjuwRRQLAQPxRZQHEvsvLKKYKIkAbD5FNvA/kZr/ExuGq5HC6wiauo1I4bWa2IQdDsXYgP+gTTZUN5DYiPpHbDqERRQjAUtXE2sgvojCnnD///8/uCMFIMAAVWsql9WKpTgAAAAASUVORK5CYII="},"l+Vj":function(t,e,a){"use strict";var s=a("DLJz");a.n(s).a},lRLZ:function(t,e,a){},lsu2:function(t,e,a){},n1CD:function(t,e,a){},nbhK:function(t,e,a){"use strict";var s=a("uBdu");a.n(s).a},nd7A:function(t,e,a){"use strict";var s=a("zIW/");a.n(s).a},oCac:function(t,e,a){},ozQO:function(t,e,a){},pKcZ:function(t,e,a){},pXDA:function(t,e,a){"use strict";var s=a("hDuR");a.n(s).a},"q6+h":function(t,e,a){"use strict";var s=a("fm0C");a.n(s).a},qLkr:function(t,e,a){"use strict";var s=a("R0bQ");a.n(s).a},rGfU:function(t,e,a){"use strict";var s=a("E8ba");a.n(s).a},rl4O:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUzM0EzN0E0RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUzM0EzN0E1RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTMzQTM3QTJFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTMzQTM3QTNFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7neeY0AAABL0lEQVR42syUv0tCURSA1Vzam5ya+h8ag5DG3GpqqsAiwVFoECJc+jGpCFZrLTpFUjQ7PPwjClxyiCY3+y6cB5fLud0rOXjhG965j++de865L5skSWaRK5dZ8JpHmIUG/MAA1v4jNLIWVKAO6/CmSWOFO3AAJbiCLVjVpLHCV9iAF3ke+6S5wDFr8Az78Ons29LHkNDImnAO3/AAZeU9I+3AZhrI/9EAU7Nd6egIbuEJJk5tL2RPzVCTpfGZ0qieZF/TMvTJzmT+TqzsbFnZ/pidYUORHcKNzF87JHMzPJXUB1ZsBY6gGyNzhUM4lhEYS6ztqZkqc4+8B1N4h4LSgH5I5gq/YFuRprL7kEwbm4kjrYrsLkbmuymp9AMu4VpGZhZz6fOeuJEWl+KP/SvAAHR5UyjSji44AAAAAElFTkSuQmCC"},u1VR:function(t,e,a){"use strict";a.r(e);var s=a("rerW"),i=a.n(s),n=a("+Gvz"),l=a("d0bK"),o={components:{TaskCell:a("Op00").a,particulars:n.default},data:function(){return{fromData:{type:"0",status:"",priority:"",date:"",subUser:""},typeOptions:[{label:"全部",key:"0"},{label:"我负责的",key:"1"},{label:"我创建的",key:"2"},{label:"我参与的",key:"3"}],subordinateOption:[{label:"全部",key:"0"},{label:"下属负责的",key:"1"},{label:"下属创建的",key:"2"},{label:"下属参与的",key:"3"}],statusOptions:[{label:"全部",key:""},{label:"正在进行",key:"1"},{label:"已完成",key:"5"}],priorityOptions:[{label:"全部",key:""},{label:"高",key:"3"},{label:"中",key:"2"},{label:"低",key:"1"},{label:"无",key:"0"}],timeOptions:[{label:"全部",key:""},{label:"今天到期",key:"1"},{label:"明天到期",key:"2"},{label:"一周到期",key:"3"},{label:"一个月到期",key:"4"}]}},mixins:[l.a],props:{listType:"",list:Array,subUserListData:{type:Array,default:function(){return[]}},loadMoreLoading:!1},mounted:function(){document.getElementById("workbench-main-container").addEventListener("click",this.taskShowHandle,!1)},methods:{selectChange:function(t,e){this.$emit("selectChange",{type:this.listType,data:this.fromData})},taskShowHandle:function(t){if(this.$refs.particulars&&!this.$refs.particulars.$el.contains(t.target)){for(var e=!0,a=document.getElementsByClassName("list-box"),s=0;s<a.length;s++){if(a[s].contains(t.target)){e=!1;break}}this.taskDetailShow=!e}},taskCellHandle:function(t){"view"==t.type&&this.showDetailView(t.data.item,t.data.index)}}},c=(a("W070"),a("ZrdR")),r=Object(c.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my-task"},[t._t("searchInput"),t._v(" "),a("div",{staticClass:"select-box"},["subtask"==t.listType?a("div",{staticClass:"select-group"},[a("label",[t._v("任务类型")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.selectChange},model:{value:t.fromData.type,callback:function(e){t.$set(t.fromData,"type",e)},expression:"fromData.type"}},t._l(t.subordinateOption,function(t){return a("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})}))],1):a("div",{staticClass:"select-group"},[a("label",[t._v("任务类型")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.selectChange},model:{value:t.fromData.type,callback:function(e){t.$set(t.fromData,"type",e)},expression:"fromData.type"}},t._l(t.typeOptions,function(t){return a("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})}))],1),t._v(" "),a("div",{staticClass:"select-group"},[a("label",[t._v("状态")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.selectChange},model:{value:t.fromData.status,callback:function(e){t.$set(t.fromData,"status",e)},expression:"fromData.status"}},t._l(t.statusOptions,function(t){return a("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})}))],1),t._v(" "),a("div",{staticClass:"select-group"},[a("label",[t._v("优先级")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.selectChange},model:{value:t.fromData.priority,callback:function(e){t.$set(t.fromData,"priority",e)},expression:"fromData.priority"}},t._l(t.priorityOptions,function(t){return a("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})}))],1),t._v(" "),a("div",{staticClass:"select-group"},[a("label",[t._v("截止时间")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.selectChange},model:{value:t.fromData.date,callback:function(e){t.$set(t.fromData,"date",e)},expression:"fromData.date"}},t._l(t.timeOptions,function(t){return a("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})}))],1),t._v(" "),"subtask"==t.listType?a("div",{staticClass:"select-group"},[a("label",{staticClass:"min-width"},[t._v("负责人")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.selectChange},model:{value:t.fromData.subUser,callback:function(e){t.$set(t.fromData,"subUser",e)},expression:"fromData.subUser"}},t._l(t.subUserListData,function(t){return a("el-option",{key:t.userId,attrs:{label:t.realname,value:t.userId}})}))],1):t._e()]),t._v(" "),a("div",{staticClass:"list-box-container"},[a("div",{staticClass:"list-box"},t._l(t.list,function(e,s){return a("task-cell",{key:s,attrs:{data:e,dataIndex:s},on:{"on-handle":t.taskCellHandle}})})),t._v(" "),a("p",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)]),t._v(" "),t.taskDetailShow?a("particulars",{ref:"particulars",attrs:{id:t.taskID,detailIndex:t.detailIndex},on:{"on-handle":t.detailHandle,close:t.closeBtn}}):t._e()],2)},[],!1,null,"9e77a796",null);r.options.__file="myTask.vue";var d=r.exports,u=a("6ZY3"),m=a.n(u),h=a("KTTK"),p=a("1RnH"),v=a("0hym"),f={components:{relatedBusiness:p.a,XhUser:v.a},data:function(){return{formInline:{priority:0},formList:[{label:"任务名称",field:"name"},{label:"负责人",field:"mainUserId",type:"popover"},{label:"开始时间",field:"startTime",type:"time"},{label:"结束时间",field:"stopTime",type:"time"},{label:"优先级",field:"priority",type:"priority"},{label:"任务描述",field:"description",type:"textarea"}],uploadFile:[],colleaguesList:[],popoverModel:!1,rules:{name:[{required:!0,message:"任务名称不能为空",trigger:"blur"},{max:50,message:"任务名称长度最多为50个字符",trigger:"blur"}]},relevanceAll:{},allData:{},radio:!0}},props:{newDialogVisible:Boolean,newLoading:Boolean},created:function(){},methods:{handleClose:function(){this.$emit("handleClose")},dialogVisibleSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;var a=m()({},t.formInline);a={mainUserId:0==t.colleaguesList.length?"":t.colleaguesList[0].userId,startTime:t.formInline.startTime,stopTime:t.formInline.stopTime,description:t.formInline.description,priority:t.formInline.priority,name:t.formInline.name,customerIds:t.relevanceAll.customerIds&&t.relevanceAll.customerIds.length?","+t.relevanceAll.customerIds.join(",")+",":"",contactsIds:t.relevanceAll.contactsIds&&t.relevanceAll.contactsIds.length?","+t.relevanceAll.contactsIds.join(",")+",":"",businessIds:t.relevanceAll.businessIds&&t.relevanceAll.businessIds.length?","+t.relevanceAll.businessIds.join(",")+",":"",contractIds:t.relevanceAll.contractIds&&t.relevanceAll.contractIds.length?","+t.relevanceAll.contractIds.join(",")+",":""},t.$emit("dialogVisibleSubmit",a)})},checkInfos:function(t){this.relevanceAll=t},changeCheckout:function(t){this.colleaguesList=t.data},selectDelect:function(t,e){this.radio&&this.$refs.xhuser[0].changeCheckout([]),this.colleaguesList.splice(e,1)}}},g=(a("l+Vj"),a("J2yD"),Object(c.a)(f,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-task-dialog"},[s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.newLoading,expression:"newLoading"}],attrs:{title:"新建任务",visible:t.newDialogVisible,width:"700px","show-close":!1,"close-on-click-modal":!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.newDialogVisible=e}}},[s("img",{staticClass:"el-icon-close",attrs:{src:a("cjwK"),alt:""},on:{click:t.handleClose}}),t._v(" "),s("el-form",{ref:"form",attrs:{model:t.formInline,rules:t.rules}},[t._l(t.formList,function(e,a){return s("el-form-item",{key:a,class:"el-form-item-"+e.field,attrs:{label:e.label,prop:e.field}},["textarea"==e.type?s("el-input",{attrs:{autosize:{minRows:4},type:"textarea"},model:{value:t.formInline[e.field],callback:function(a){t.$set(t.formInline,e.field,a)},expression:"formInline[item.field]"}}):"time"==e.type?s("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.formInline[e.field],callback:function(a){t.$set(t.formInline,e.field,a)},expression:"formInline[item.field]"}}):"priority"==e.type?s("div",{staticClass:"priority-box"},[s("el-radio-group",{attrs:{fill:"red","text-color":"#FFF"},model:{value:t.formInline[e.field],callback:function(a){t.$set(t.formInline,e.field,a)},expression:"formInline[item.field]"}},[s("el-radio",{attrs:{label:3}},[t._v("高")]),t._v(" "),s("el-radio",{attrs:{label:2}},[t._v("中")]),t._v(" "),s("el-radio",{attrs:{label:1}},[t._v("低")]),t._v(" "),s("el-radio",{attrs:{label:0}},[t._v("无")])],1)],1):"popover"==e.type?s("div",{staticClass:"type-popover"},[s("el-popover",{attrs:{placement:"bottom-end",width:"280",trigger:"click"}},[s("xh-user",{ref:"xhuser",refInFor:!0,attrs:{radio:t.radio,selectedData:t.colleaguesList},on:{changeCheckout:t.changeCheckout}}),t._v(" "),s("div",{staticClass:"select-box",attrs:{slot:"reference"},slot:"reference"},[t._l(t.colleaguesList,function(e,a){return s("span",{key:a,staticClass:"select-box-span"},[t._v("\n                "+t._s(e.realname)+"\n                "),s("span",{staticClass:"el-icon-close",on:{click:function(s){s.stopPropagation(),t.selectDelect(e,a)}}})])}),t._v(" "),s("span",{staticClass:"el-icon-plus"})],2)],1)],1):s("el-input",{model:{value:t.formInline[e.field],callback:function(a){t.$set(t.formInline,e.field,a)},expression:"formInline[item.field]"}})],1)}),t._v(" "),s("related-business",{attrs:{allData:t.allData,marginLeft:"0"},on:{checkInfos:t.checkInfos}})],2),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:t.dialogVisibleSubmit}},[t._v("保存")]),t._v(" "),s("el-button",{on:{click:t.handleClose}},[t._v("取消")])],1)],1)],1)},[],!1,null,"e62c491c",null));g.options.__file="newDialog.vue";var b=g.exports,k=a("+9th"),y={components:{myTask:d,newDialog:b},data:function(){return{activeName:"mytask",activePramas:{priority:""},tabData:[{label:"我的任务",key:"mytask"},{label:"我下属的任务",key:"subtask"}],listData:[],dialogVisible:!1,newLoading:!1,loading:!0,searchValue:"",subUserListData:[],pageNum:1,loadText:"加载更多",loadMoreLoading:!0,isPost:!1}},watch:{$route:function(t,e){this.$router.go(0)}},beforeRouteUpdate:function(t,e,a){1==t.query.routerKey&&this.newBtn(),a()},created:function(){1==this.$route.query.routerKey&&this.newBtn(),this.subUserFun()},mounted:function(){var t=this,e=function(e){e.onscroll=function(){var a=e;a.scrollTop+a.clientHeight==a.scrollHeight&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.pageNum++,t.getList(t.pageNum)))}},a=!0,s=!1,n=void 0;try{for(var l,o=i()(document.getElementsByClassName("list-box-container"));!(a=(l=o.next()).done);a=!0){e(l.value)}}catch(t){s=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(s)throw n}}this.getList()},methods:{subUserFun:function(){var t=this;Object(h.i)({pageType:0}).then(function(e){t.subUserListData=e.data,t.subUserListData.unshift({userId:"",realname:" 全部"})}).catch(function(){})},handleClick:function(){this.activePramas=this.$refs[this.activeName][0].fromData,this.refreshList()},newBtn:function(){this.dialogVisible=!0},handleClose:function(t){"shortcut"==t?this.$router.push("task"):1==this.$route.query.routerKey?this.$router.go(-1):this.dialogVisible=!1},dialogVisibleSubmit:function(t){var e=this;this.newLoading=!0,Object(k.a)(t).then(function(t){e.refreshList(),e.handleClose("shortcut"),e.$message.success("新建成功"),e.newLoading=!1,e.dialogVisible=!1}).catch(function(t){e.newLoading=!1,e.dialogVisible=!1})},selectChange:function(t){var e={status:t.data.status,type:t.data.type,priority:t.data.priority,date:t.data.date};"subtask"==t.type?e.userId=t.data.subUser:e.userId="",this.activePramas=e,this.refreshList()},refreshList:function(){this.pageNum=1,this.listData=[],this.loadMoreLoading=!0,this.getList()},searchChange:function(){this.refreshList()},getList:function(){var t=this;this.loading=!0;var e=this.activePramas;e.limit=15,e.page=this.pageNum,e.search=this.searchValue,"subtask"==this.activeName&&(e.mold=1),Object(k.k)(e).then(function(e){var a=!0,s=!1,n=void 0;try{for(var l,o=i()(e.data.list);!(a=(l=o.next()).done);a=!0){var c=l.value;5==c.status&&(c.checked=!0)}}catch(t){s=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(s)throw n}}t.listData=t.listData.concat(e.data.list),e.data.list.length<15?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.isPost=!1,t.loading=!1}).catch(function(e){t.isPost=!1,t.loading=!1})}}},C=(a("I6we"),Object(c.a)(y,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task oa-bgcolor"},[a("div",{staticClass:"header"},[a("el-button",{staticClass:"new-btn",attrs:{type:"primary"},on:{click:t.newBtn}},[t._v("新建任务")]),t._v(" "),a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tabData,function(e,s){return a("el-tab-pane",{key:s,attrs:{label:e.label,name:e.key}},[a("my-task",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:e.key,refInFor:!0,attrs:{list:t.listData,listType:e.key,subUserListData:t.subUserListData,loadMoreLoading:t.loadMoreLoading},on:{selectChange:t.selectChange}},[a("div",{staticClass:"search-input",attrs:{slot:"searchInput"},slot:"searchInput"},[a("el-input",{attrs:{size:"medium",placeholder:"搜索任务名称","suffix-icon":"el-icon-search"},on:{input:t.searchChange},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1)])],1)}))],1),t._v(" "),a("new-dialog",{attrs:{newDialogVisible:t.dialogVisible,newLoading:t.newLoading},on:{handleClose:t.handleClose,dialogVisibleSubmit:t.dialogVisibleSubmit}})],1)},[],!1,null,"70f52f24",null));C.options.__file="index.vue";e.default=C.exports},uBdu:function(t,e,a){},uMjE:function(t,e,a){"use strict";a.r(e);var s=a("7Qib"),i=a("mqlf"),n=a("ppJE"),l=a("PS1M"),o=a("n1dw"),c=a("xfX+"),r=a("8gwX"),d=a("K6D0"),u=a("7z+D"),m={name:"c-r-m-full-screen-detail",components:{ClueDetail:i.a,CustomerDetail:n.a,ContactsDetail:l.a,BusinessDetail:o.a,ContractDetail:c.a,ProductDetail:r.a,MoneyDetail:d.a,ExamineDetail:u.a},watch:{visible:function(t){this.showDetail=t,t&&(document.body.appendChild(this.$el),this.$el.addEventListener("click",this.handleDocumentClick,!1),this.$el.style.zIndex=Object(s.g)())},showDetail:function(t){var e=this;t||setTimeout(function(){e.$emit("update:visible",!1)},350)}},computed:{tabName:function(){return"leads"==this.crmType?"clue-detail":"customer"==this.crmType?"customer-detail":"contacts"==this.crmType?"contacts-detail":"business"==this.crmType?"business-detail":"contract"==this.crmType?"contract-detail":"product"==this.crmType?"product-detail":"receivables"==this.crmType?"money-detail":"examine"==this.crmType?"examine-detail":""}},data:function(){return{showDetail:!1}},props:{id:[String,Number],crmType:{type:String,default:""},visible:{type:Boolean,default:!1}},mounted:function(){this.visible&&(document.body.appendChild(this.$el),this.$el.addEventListener("click",this.handleDocumentClick,!1),this.$el.style.zIndex=Object(s.g)())},methods:{hiddenView:function(){this.showDetail=!1},handleDocumentClick:function(t){t.stopPropagation(),this.$el==t.target&&(this.showDetail=!1)}},beforeDestroy:function(){this.$el&&this.$el.parentNode&&(this.$el.parentNode.removeChild(this.$el),this.$el.removeEventListener("click",this.handleDocumentClick,!1))}},h=(a("VU1q"),a("ZrdR")),p=Object(h.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"full-container"},[t.id&&t.showDetail?a(t.tabName,{tag:"component",staticClass:"d-view",attrs:{crmType:t.crmType,id:t.id},on:{"hide-view":t.hiddenView}}):t._e()],1)},[],!1,null,"2cff152a",null);p.options.__file="CRMFullScreenDetail.vue";e.default=p.exports},v84z:function(t,e,a){"use strict";var s=a("hmIG");a.n(s).a},vPra:function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"a",function(){return n}),a.d(e,"b",function(){return l});var s=a("t3Un");function i(t){return Object(s.a)({url:"comment/setComment",method:"post",data:t})}function n(t){return Object(s.a)({url:"comment/deleteComment",method:"post",data:t})}function l(t){return Object(s.a)({url:"comment/queryCommentList",method:"post",data:t})}},vnKs:function(t,e,a){},woiz:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhGQTE4Q0EzRjM4ODExRThCNjlDOEQxMEUxMzYwREE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhGQTE4Q0E0RjM4ODExRThCNjlDOEQxMEUxMzYwREE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEZBMThDQTFGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEZBMThDQTJGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4R34ZtAAABfUlEQVR42pzUPUsDQRDG8eTQVBZiQhqxU6KoWKiFhaAQ21gqQcXGTxDFSsRKBOMXsBGi+NLFlBYighbmClGLgFZiE1+wECGd/4HnZDmSIA78uNzN7LC3t5touVyOhKINS5jGIDrwgTsUsYsvd4AXapBFBaPIoxdRXfN6XlHdb7Q4v9exgAz8UPNXlGQYJ+jBhtskqwZjqEaah6+6azxh39MabGPmDw2CqKp+B+3WZBHnCFb4UuqFm7P6M8x5WoNCqDjaZBZuzsZlbE36nVlYjDdpEM7dYsBmksBb5H/xjrinHwknUUOswaCY8kHEbbw1uceIk3jWHqgX9vzFuR/CgzU5xbyTONTGqxdroY9g44rWZA+Tzmw20Ykj9KFVV7vvwpbqrH4q2Gx2mFZUlMQ30jojJeVLuk8rn1R9Dp/Btj9AN660E329Ur3XsrNzrNcqhA+gHaZHrdGF1sbX549r+rOYwKq9RqO/AptRCjdY1n9ITV8wp02ZchtY/AgwAM3YV79CKIEGAAAAAElFTkSuQmCC"},xw4X:function(t,e,a){},y9lt:function(t,e,a){"use strict";var s=a("rerW"),i=a.n(s),n=a("KzkL"),l={name:"follow-schedule-cell",components:{},props:{data:Object},data:function(){return{}},filters:{getRemindtypeText:function(t){switch(t){case 0:return"无";case 1:return"准时提醒";case 2:return"5分钟前";case 3:return"15分钟前";case 4:return"30分钟前";case 5:return"一个小时前";case 6:return"二个小时前";case 7:return"一天前";case 8:return"二天前";case 9:return"一周前"}return""}},computed:{},mounted:function(){},methods:{checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})}}},o=(a("3JdR"),a("ZrdR")),c=Object(o.a)(l,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"fl-c"},[s("flexbox",{staticClass:"fl-h"},[s("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),t._v(" "),s("div",{staticClass:"fl-h-b"},[s("div",{staticClass:"fl-h-name"},[t._v(t._s(t.data.createUser.realname))]),t._v(" "),s("div",{staticClass:"fl-h-time"},[t._v(t._s(t.data.createTime))])]),t._v(" "),!t.data.permission||1!=t.data.permission.isUpdate&&1!=t.data.permission.isDelete?t._e():s("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[s("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD"}}),t._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.data.permission&&1==t.data.permission.isUpdate?s("el-dropdown-item",{attrs:{command:"edit"}},[t._v("编辑")]):t._e(),t._v(" "),t.data.permission&&1==t.data.permission.isDelete?s("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")]):t._e()],1)],1)],1),t._v(" "),s("div",{staticClass:"fl-b"},[s("div",[s("div",{staticClass:"state-color",style:{"background-color":t.data.color?t.data.color:"#fff"}}),t._v(t._s(t.data.title)+"\n    ")]),t._v(" "),s("div",{staticClass:"fl-b-des"},[s("flexbox",{staticClass:"fl-b-des-item"},[s("div",{staticClass:"fl-b-des-item-name"},[t._v("参与人：")]),t._v(" "),s("div",{staticClass:"owner-list"},t._l(t.data.ownerList,function(e,a){return s("span",{key:a},[s("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("span",[t._v(t._s(e.realname))])]),t._v(" "),s("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"k"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.img),expression:"$options.filters.filterUserLazyImg(k.img)",arg:"background-image"}],key:e.img,staticClass:"div-photo header-circle"})])],1)}))]),t._v(" "),s("flexbox",{staticClass:"fl-b-des-item"},[s("div",{staticClass:"fl-b-des-item-name"},[t._v("开始时间：")]),t._v(" "),s("div",[t._v(t._s(t.data.startTime))])]),t._v(" "),s("flexbox",{staticClass:"fl-b-des-item"},[s("div",{staticClass:"fl-b-des-item-name"},[t._v("结束时间：")]),t._v(" "),s("div",[t._v(t._s(t.data.endTime))])]),t._v(" "),s("flexbox",{staticClass:"fl-b-des-item"},[s("div",{staticClass:"fl-b-des-item-name"},[t._v("备注：")]),t._v(" "),s("div",[t._v(t._s(t.data.remark))])])],1),t._v(" "),t.data.contactsList.length>0||t.data.customerList.length>0||t.data.businessList.length>0||t.data.contractList.length>0?s("div",{staticClass:"related-business"},[s("div",{staticClass:"label"},[t._v("关联业务")]),t._v(" "),t._l(t.data.contactsList,function(e,i){return s("p",{key:"contacts"+i,on:{click:function(a){t.checkRelatedDetail("contacts",e)}}},[s("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n        联系人-"+t._s(e.name)+"\n      ")])}),t._v(" "),t._l(t.data.customerList,function(e,i){return s("p",{key:"customer"+i,on:{click:function(a){t.checkRelatedDetail("customer",e)}}},[s("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n        客户-"+t._s(e.customerName)+"\n      ")])}),t._v(" "),t._l(t.data.businessList,function(e,i){return s("p",{key:"business"+i,on:{click:function(a){t.checkRelatedDetail("business",e)}}},[s("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n        商机-"+t._s(e.businessName)+"\n      ")])}),t._v(" "),t._l(t.data.contractList,function(e,i){return s("p",{key:"contract"+i,on:{click:function(a){t.checkRelatedDetail("contract",e)}}},[s("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n        合同-"+t._s(e.name)+"\n      ")])})],2):t._e()])],1)},[],!1,null,"6f1401b3",null);c.options.__file="FollowScheduleCell.vue";var r=c.exports,d=a("Dh/N"),u=a("BuGm"),m=(a("7Qib"),{name:"schedule-log",components:{FollowScheduleCell:r,CRMFullScreenDetail:function(){return Promise.all([a.e("chunk-0005"),a.e("chunk-276e"),a.e("chunk-162a"),a.e("chunk-2ce5")]).then(a.bind(null,"uMjE"))},CreateSchedule:u.default},props:{id:[String,Number],crmType:{type:String,default:""}},watch:{id:function(t){this.refreshList()}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],showFullDetail:!1,detailCRMType:"",rowID:"",showDialog:!1,formData:{checkList:[]},newtext:""}},computed:{},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){e.scrollTop+e.clientHeight==e.scrollHeight&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0;var e={page:this.page,limit:10};e[this.crmType+"Ids"]=this.id,Object(n.j)(e).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(t){var e=this;if("edit"==t.type){this.newText="编辑日程";var a=t.data.item;a.startTime=a.startTime,a.endTime=a.endTime,a.ownerUserIds=[];var s=!0,n=!1,l=void 0;try{for(var o,c=i()(a.ownerList);!(s=(o=c.next()).done);s=!0){var r=o.value;a.ownerUserIds.push(r.userId)}}catch(t){n=!0,l=t}finally{try{!s&&c.return&&c.return()}finally{if(n)throw l}}this.formData=a,this.showDialog=!0}else"delete"==t.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.b)({eventId:t.data.item.eventId}).then(function(t){e.refreshList(),e.$message({type:"success",message:"删除成功!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):"related-detail"==t.type&&(this.rowID=t.data.item[t.data.type+"Id"],this.detailCRMType=t.data.type,this.showFullDetail=!0)},onSubmit:function(t,e){this.refreshList(),"创建日程"==this.newText?(this.$message.success("新建成功"),this.showDialog=!1):(this.$message.success("编辑成功"),this.showDialog=!1)}}}),h=(a("qLkr"),Object(o.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[a("div",{staticClass:"log-items"},[t._l(t.list,function(e,s){return a("follow-schedule-cell",{key:s,attrs:{data:e},on:{"on-handle":t.examineCellHandle}})}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{type:"text",loading:t.loadMoreLoading}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,crmType:t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.showDialog?a("create-schedule",{attrs:{text:t.newText,formData:t.formData,appendToBody:!0},on:{onSubmit:t.onSubmit,closeDialog:function(e){t.showDialog=!1}}}):t._e()],1)},[],!1,null,"41466ce4",null));h.options.__file="ScheduleLog.vue";e.a=h.exports},"zIW/":function(t,e,a){},zukx:function(t,e,a){}}]);